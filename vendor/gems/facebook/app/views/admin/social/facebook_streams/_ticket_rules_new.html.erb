<div class="form-horizontal">
  <%= hidden_field_tag "social_ticket_rule[][ticket_rule_id]", ticket_rule.id %>
  <div class="row-fluid">
    <div class='form_data span11 mlt'>
      <div class="control-group fb-form-tkt-rules">
        <input id="social_ticket_rule__rule_type" name="social_ticket_rule[][rule_type]" type="hidden"
          value="<%= ticket_rule.filter_data[:rule_type] %>">
        <div class="mt20">
          <div class="bold-text mb15 ml10"><%= t(".page_posts_label") %></div>
          <div class="rule-settings">
            <div class="optimal-rules-container pl10">
              <%= hidden_field_tag "default_keywords", "#{Facebook::Constants::DEFAULT_KEYWORDS.join(',')}"%>
              <div class="checkbox">
                <label><%= check_box_tag 'social_ticket_rule[][import_visitor_posts]', true, ticket_rule.import_visitor_posts? %>&nbsp;
                  <span id="import_visitor_posts_text">
                    <%= t(".convert_visitor_post_to_ticket") %>
                  </span>
                </label>
                <label id="import_visitor_posts_helptext" class="muted">&nbsp; <%= t(".visitor_posts_helptext") %></label>
              </div>
              <div class="checkbox">
                <label><%= check_box_tag 'social_ticket_rule[][import_company_comments]', true, ticket_rule.import_company_comments? %>&nbsp;<%= t(".convert_page_post_to_ticket") %></label>
              </div>
              <div class="keyword_wrapper form-group clearfix pl20">
                <label id="same_ticket_threading_container">
                  <input type="radio" id="same_ticket_threading" name="threading" class="threading">
                  &nbsp;<%= t(".fb_thread_same_ticket") %>
                </label>
                <div class="pl20" id = "same_ticket_filter_mentions_container">
                  <label><%= check_box_tag 'same_ticket_filter_mentions', true, ticket_rule.filter_mentions? %>&nbsp;<%= t("admin.social.ticket_rules.filter_mentions") %></label>
                </div>
                <label id="new_ticket_threading_container">
                  <input type="radio" id="new_ticket_threading" name="threading" class="threading">
                  &nbsp;<%= t(".fb_thread_new_ticket") %>
                </label>
                <div class="keyword_container pl20">
                  <label>
                    <!-- dummy checkbox for UX revamp -->
                    <input type="checkbox" id="toggle_keywords">
                    &nbsp;<%= t(".convert_comment_toggle_helptext") %>
                  </label>
                  <%= text_field_tag "social_ticket_rule[][includes]",
                    ticket_rule.include_keys,
                    :class => 'text social_ticket_rule_includes form-control span12 pl20' %>
                </div>
                <div class="pl20" id = "new_ticket_filter_mentions_container">
                  <label><%= check_box_tag 'new_ticket_filter_mentions', true, ticket_rule.filter_mentions? %>&nbsp;<%= t("admin.social.ticket_rules.filter_mentions") %></label>
                </div>
              </div>

              <div class="control-group mt10">
                <label class="mt10 pl5">
                  <%= t('.assign_to_gp')%>
                  <%= select_tag "social_ticket_rule[][group_id]", options_for_select(current_account.support_agent_groups_from_cache.collect{ |c| [c.name, c.id]}.insert(0, '...'), ticket_rule.group_id), {:class => "select2-container span4 ml10"} %>
                </label>
              </div>
            </div>
          </div>
          <% if Account.current.fb_ad_posts_enabled? %>
          <% is_ad_post_enabled = facebook_page.ad_post_stream.rules.present? ? true : false %>
          <% ad_post_group_id = facebook_page.ad_post_stream.rules.present? ? facebook_page.ad_post_stream.rules.first[:action][:group_id] : 0 %>
          <% ad_post_ticket_rule = facebook_page.ad_post_stream.ticket_rules.first if is_ad_post_enabled%>

          <% ad_posts_filter_mentions = ad_post_ticket_rule.present? ? ad_post_ticket_rule.filter_data[:filter_mentions] : false %>
            <div class="mb15 bold-text"><%= t(".ad_posts_label") %></div>
            <label>
              <%= hidden_field_tag 'ad_posts[import_ad_posts]]', "false" %>
              <%= check_box_tag 'ad_posts[import_ad_posts]', "true", is_ad_post_enabled %>
              <span id="import_visitor_posts_text">
                &nbsp;<%= t(".convert_ad_post_to_ticket") %>
              </span>
            </label>

            <label id="import_visitor_posts_helptext" class="muted ml20">
              <%= t(".convert_ad_post_helptext") %>
            </label>

          <div class="pl20">
            <label><%= check_box_tag 'ad_posts_filter_mentions', true, ad_posts_filter_mentions %>&nbsp;<%= t("admin.social.ticket_rules.filter_mentions") %></label>
          </div>

            <div class="control-group mt10">
              <label class="mt10 pl5">
                <%= t('.assign_to_gp')%>
                <%= select_tag "ad_posts[group_id]", options_for_select(current_account.support_agent_groups_from_cache.collect{ |c| [c.name, c.id]}.insert(0, '...'), ad_post_group_id), {:class => "select2-container span4 ml10"} %>
              </label>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  (function ($) {
    $(window).on('load', function() {
      App.Admin.fbAdminConfig.init();
    });
  })(jQuery);
</script>