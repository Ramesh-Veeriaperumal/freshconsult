<div class="head">
  <%= check_box "social_facebook_page", :import_dms, { rel: 'toggle', :checked => facebook_page.import_dms } %>
  <label class="inline adm-radio" id="capture-dm">&nbsp;<%= t('.header')%></label>
</div>
<div class='adm-social sts adm-bg c-tkt dm-options <%= "hide" if !facebook_page.import_dms %>'>     
  <div id="dm-option" class="clearfix pl10">
    <div class="control-group row-fluid clearfix">
      <label for="dm-intervals" class="control-label span3"><%= t('.threading_interval')%></label> 
      <div class="controls span7">
        <%= select(:social_facebook_page ,:dm_thread_time, Social::FacebookPage::DM_THREADTIME_OPTIONS ,{:selected => facebook_page.dm_thread_time},  :class => 'select2-container select2 span6') %>
        <div class="msg help-block"><%= t('.dm_info')%></div>
      </div>
    </div> 
    <div class="control-group row-fluid clearfix">
      <label for="agent-group" class="control-label span3"><%= t('.assign_to_gp')%></label> 
      <div class="controls span7">
        <% 
          dm_stream = facebook_page.dm_stream
          group_id  = dm_stream.ticket_rules.first.action_data[:group_id] unless dm_stream.ticket_rules.empty?
        %>
        <%= collection_select(:dm_rule ,:group_assigned, current_account.support_agent_groups_from_cache, :id, :name, {:include_blank => '...',
            :selected => group_id}, :class => 'select2-container select2 span6') %>
      </div>
    </div>   
  </div>
</div>     

<script type="text/javascript">
  (function ($) {
    $('#social_facebook_page_import_dms').on('change', function () {
      if (this.checked) {
        $('.dm-options').fadeIn("slow", "linear").css('display', 'block');
      } else {
        $('.dm-options').fadeOut("slow", "linear");
      }
    });
  })(jQuery)
</script>
