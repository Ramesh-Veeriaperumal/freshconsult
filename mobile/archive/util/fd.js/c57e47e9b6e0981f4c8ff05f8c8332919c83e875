/*c57e47e9b6e0981f4c8ff05f8c8332919c83e875*/var FD=FD||{};FD.Util={onAjaxSucess:function(d,a,c,b){c.call(b,a)},onAjaxFailure:function(c,a,b){if(a.status==302){window.location=JSON.parse(a.responseText).Location}else{Ext.Msg.alert("Some thing went wrong!","We are sorry . Some thing went wrong! Our technical team is looking into it.")}},onAjaxCallback:function(e,a,b,d,c){Ext.Viewport.setMasked(false);a?this.onAjaxSucess(e,b,d,c):this.onAjaxFailure(e,b,d,c)},ajax:function(a,e,b,d){if(d!==false){Ext.Viewport.setMasked(true)}var c=this;a.callback=function(g,f,h){c.onAjaxCallback(g,f,h,e,b)};Ext.Ajax.request(a)},getJSON:function(a,c,b){a.method="GET";a.headers={Accept:"application/json"};this.ajax(a,c,b)},reBrand:function(a){Ext.Viewport.getAt(1).setBranding(a)},initCustomer:function(){Ext.ComponentQuery.query("#noteFormCannedResponse")[0].hide();Ext.ComponentQuery.query("#noteFormPrivateField")[0].hide()},showAll:function(a){document.getElementById(a).setAttribute("class","conv");document.getElementById("loadmore_"+a).setAttribute("class","hide")},check_user:function(){if(!FD.current_user){location.href="/mobile/"}},changeFavicon:function(c){document.head||(document.head=document.getElementsByTagName("head")[0]);var a=document.createElement("link"),b=document.getElementById("favicon");a.id="favicon";a.rel="shortcut icon";a.href=c;if(b){document.head.removeChild(b)}document.head.appendChild(a)},construct_ticket_form:function(a,c,f){var b=c?[{xtype:"hiddenfield",name:"_method",value:"put"}]:[{xtype:"hiddenfield",name:"commit",value:"Save"}],g,h,d,i,e=this;a.forEach(function(j){i=j.ticket_field;d=e.construct_ticket_field(i);d.listeners=f;d.nested_choices=e.get_nested_field_choices(i.nested_choices);d.nested_levels=i.nested_levels;b.push(d);if(i.nested_levels){e.construct_nested_fields(b,i,f)}});return b},get_nested_field_choices:function(a,c){var b={};a.forEach(function(d){b[d[1]]=d[2]});return b},construct_nested_fields:function(f,e,b){var d=e.nested_choices,c=this,h=e.nested_levels,a=1,g=e.field_value&&e.field_value.category_val;subcatVal=e.field_value&&e.field_value.subcategory_val,itemVal=e.field_value&&e.field_value.item_val,parent_nested_choices=this.get_nested_field_choices(d);h.forEach(function(i){var j={domtype:"dropdown_blank",is_default_field:false};j.label=i.label;j.field_name=i.name;j.field_value=a==1?subcatVal:itemVal;form_field=c.construct_ticket_field(j);form_field.listeners=b;form_field.nested_levels=a==1?[h[a]]:undefined;form_field.id="nested_"+i.name;form_field.cls="nestedField";if(!j.field_value){form_field.hidden=true}else{var k=c.getChildOptionsObj(parent_nested_choices,g);form_field.options=k.options;form_field.nested_choices=k.nested_choices;g=subcatVal;parent_nested_choices=k.nested_choices}form_field.level=++a;f.push(form_field)})},construct_ticket_field:function(e){var d={options:[]},f,b,a,c=e.field_name;d.label=e.label;d.name=e.is_default_field?"helpdesk_ticket["+c+"]":"helpdesk_ticket[custom_field]["+c+"]";d.required=e.required;d.value=e.nested_levels&&e.field_value?e.field_value.category_val:e.field_value;switch(e.domtype){case"dropdown_blank":d.options=[{text:"...",value:""}];case"dropdown":d.xtype="selectfield";f=e.choices;for(a in f){b=f[a];d.options.push({text:b[0],value:b[1]})}break;case"text":d.xtype="textfield";break;case"hidden":d.xtype="hiddenfield";break;case"html_paragraph":case"text":case"paragraph":d.xtype="textareafield";break;case"checkbox":d.xtype="checkboxfield";break;case"number":d.xtype="numberfield";break;default:d.xtype="textfield";break}return d},validate_form:function(c){var a=c.getItems().items[0].items.items,b=true;a.forEach(function(d){if(d.getRequired()&&!d.getValue()){d.setCls("required");b=false}});return b},getChildOptionsObj:function(b,d){if(!b){return}var e=b[d],c=[{text:"...",value:""}],a={};if(e){e.forEach(function(f){c.push({text:f[0],value:f[1]});a[f[1]]=f[2]})}return{options:c,nested_choices:a}},enable_nested_field:function(a){var e=a.config,c=e.nested_choices,h=e.nested_levels,g=e.level,b,f=a.getValue(),d=[];if(!h){return}b=Ext.getCmp("nested_"+h[0].name);if(!!f){child_options_object=FD.Util.getChildOptionsObj(c,f);b.setOptions(child_options_object.options).setHidden(false);b.config.nested_choices=child_options_object.nested_choices}else{b.setHidden(true).setValue("")}}};