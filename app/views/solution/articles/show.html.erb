<% if missing_translations?(@article) && (!@article.new_record?  or !privilege?(:manage_solutions)) %>
	<div class="hide never-close" id="add-translations">
		<%= render :partial => "add_translations" %>
	</div>
<% else %>
	<% content_for :sidebar do %>
		<div class="solution-sidebar">
			<%= not_in_portal_notification(@article) %>
			<% if @article.new_record? %>
				<%= render partial: "new_translation_helpnote" %>
			<% else %>
				<%= render partial: "sidebar" %>
			<% end %>
		</div>
	<% end %>
<% end %>

<div class="solutions">
  <% unless current_account.verified? %>
  		<div class="account-verify-alert account-not-verified"><%= t('portal.article.activation_warning') %></div>
  <% end %>


	<% content_for :layoutType do %><%= solution_body_classes %><% end %>
	<% content_for :sticky_title do %>
		<%= render :partial => "show_master" if Account.current.multilingual? && !@article.is_primary? %>
		<div class="language-tabs">
			<%= render :partial => "language_tabs" if Account.current.multilingual? %>
      <div class="clearfix"></div>
		</div>
		<div class="solution-header draft-notif" id="solution-notification-bar">
			<%= render :partial => 'notification_bar' %>
		</div>

	<% end %>
	<% content_for :sticky_right do %>
	  	<% unless @article.solution_folder_meta.visibility == Solution::Constants::VISIBILITY_KEYS_BY_TOKEN[:bot] %>
	  		<%= preview_portal(support_solutions_article_path(@article, path_url_locale), @article.solution_folder_meta.solution_category_meta, 'mt6') if @article.published? %>
	  	<% end %>
	  <% if privilege?(:publish_solution) %>
      <% unless @article.new_record? || (@article.draft.present? && @article.draft.locked?) %>
    	  <div class="pagination-right edit-container">
					<% if @article.published? %>
						<button class="btn article-link-copy-btn" data-text-copied="<%= t('copied_link') %>">
							<a href="<%= portal_article_path(multilingual_article_path(@article, path_url_locale), @article.solution_folder_meta.solution_category_meta) %>" class="hidden" id="article-link-copy-btn"></a>
							<span class="ficon-clone"></span>
							<span class="content">	<%= t('copy_link') %></span>
						</button>
					<% end %>
    	    <a href="javascript:void(0)" class="btn btn-primary article-edit-btn"><%= t('edit') %></a>
    	  </div>
      <% end %>
    <% end %>
    <div class="pagination-right breadcrumb-btns <%= 'hide' unless @article.new_record? %>">
      <%= article_btns('save-btn', 'publish-btn') %>
    </div>
	<% end %>
	<%= render :partial => '/solution/shared/sticky',
						 :locals => { :page => :article, :sticky_class => 'article-sticky', :toolbar => true} %>

	<!-- Solution page content -->
	<div class="solution-content">
		<%= render :partial => "view" unless @article_meta.present? && @article.new_record? %>
		<%= render :partial => "article_form" unless @article.draft.present? && @article.draft.locked? %>
	</div>

</div>

<script type="text/javascript">
	var MAX_TAG_LENGTH_MSG = "<%= I18n.t('helpdesk.tickets.show.max_tag_length_msg') %>";
	jQuery('body').one('assetLoaded.fjax', function() {
		App.Solutions.NavMenu.setActiveFolderAs(<%= @article.folder_id %>);
		App.Solutions.Article.STRINGS = {
			reload: "<%= escape_javascript(t('reload')).html_safe %>",
			unsavedContent: "<%= escape_javascript(t('solution.general.unsaved_content')).html_safe %>",
			leaveQuestion: "<%= escape_javascript(t('solution.general.leave_page_que')).html_safe %>",
			somethingWrong: "<%= escape_javascript(t('solution.general.something_wrong')).html_safe %>",
			maxInput: "<%= escape_javascript(t('solution.articles.tag_max_len')).html_safe %>",
			articleDeleted: "<%= escape_javascript(t('solution.articles.article_deleted')).html_safe %>",
			back: "<%= escape_javascript(t('back')).html_safe %>",
			addTranslationsTitle: "<%= escape_javascript(t('solution.articles.missing_translations.title')).html_safe %>"
    };
		<%= 'App.namespace = "solution/articles/new";'.html_safe if @article_meta.present? && @article.new_record? %>
		<% if missing_translations?(@article) && (!@article.new_record?  or !privilege?(:manage_solutions)) %>
			App.Solutions.Article.triggerTranslationsModal();
		<% end %>
	});

	jQuery(document).ready(function(){
		window.App = window.App || {};
		window.App.Channel = window.App.Channel || new MessageChannel();
	});

	jQuery("#manage-account-languages").on("click", function(e){
    if(!jQuery.browser.msie && !jQuery.browser.msedge) {
		  e.preventDefault();
		}
		window.App.Channel.port1.postMessage({action: "manage-language"});
	});
</script>
