<div class="form-horizontal">
	<div class="control-group">
		<label for="topic_title" class="control-label"><%= t('topic.name') %>*</label>
		<div class="controls">
			<%= form.text_field :title, :onchange => "/*TopicForm.editNewTitle(this);*/", :class => "required text", :tabindex => 10 %>
		</div>
	</div>
	<div class="control-group">
		<label for="topic_body" class="control-label"><%= t('message') %></label>
		<div class="controls">
			<%= form.rich_editor(:body_html, 
			:value => !@topic.new_record? ? @topic.posts.first.body_html : "", 
			:tabindex => 20, :height => "200px", 'editor-type' => :forum) %>
		</div>
	</div>
	<% if privilege?(:view_admin) and not @topic.new_record? %>
		<div id="topic_forum_id" class="control-group">
	  		<label for="topic_forum_id" class="control-label"><%= t('forum.title') %></label>
	  		<div class="controls">
	  			<%= form.select :forum_id, Forum.find(:all,:conditions =>['account_id = ?',current_account.id], :order => "position").map {|x| [x.name, x.id] } %>
	  		</div>
		</div>
	<% end %>
	<div class="inlineChecklist control-group">
		<% if privilege?(:view_admin) or current_user.moderator_of?(@topic.forum) %>
			<div class="controls">
				<div class="checkbox inline">
					<%= form.check_box :sticky %> <%= t('topic.sticky') %>
				</div>
				<div class="checkbox inline">
					<%= form.check_box :locked %> <%= t('topic.locked') %>
				</div>
			</div>
		<% end %>
	</div>	  
	<div class="control-group">
		<div class="controls">
			<%= render :partial=> "/forum_shared/attachment_form" %>
			<% unless @topic.new_record? %>
				<div class="attachment-list-container">
				    <%= content_tag('h5', 'Attachments') unless @topic.posts.first.attachments.empty? %>	
				    <table class="attachment-list">
				      <%= render(
				        :partial => '/helpdesk/shared/attachment', 
				        :collection => @topic.posts.first.attachments,
				        :locals => {:show_delete => true, :url => [@topic.posts.first] }) %>
				    </table>
				</div>
			<%end%>
		</div>
	</div>
	<% if is_application_installed?("screenr") %>
	  <div class="control-group">
	  	<div class="controls">
			<%= render :partial => "shared/screenr_recorder", :locals => { :location => "agent_forum" } %>
		</div>
	  </div>
	<% end %>
</div>

<% javascript_tag do %>
	jQuery("#topic_locked").click(function(ev){
		jQuery("#monitor-topic-lable").toggle(!this.checked);
	});
	 .toggle(!jQuery("#topic_locked").checked);
<% end %>

<script id="file-list-template" type="text/x-jquery-tmpl">			
  <tr>
    <td class="remove">
      <a href="" onclick="Helpdesk.Multifile.remove(this); return false;", inputId="${inputId}">
        <%= image_tag("helpdesk/delete.png") %>
      </a>
    </td>
    <td class="name">${name}</td>
    <td>
      <label>Description</label>
      <input type="text" name="helpdesk_article[attachments][][description]" />
    </td>
    </tr>
</script>