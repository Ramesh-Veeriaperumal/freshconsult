<% 
	placeholder ||= "Search"
	url			||= "/search/content?search_key="
	url = url.gsub('/search', '/search/home') if es_enabled?
%>
<form class="page-search" >
	<div class="live_search">
		<input class="search" type="text" id="PageSearch" placeholder="<%= placeholder.html_safe %>" /> 
	</div>
</form>

<div id="search_results" style="display:none;"></div>
<script type="text/javascript">
	callbackToPageSearch = function(string){
								jQuery.ajax({ 
									url: "<%=url%>"+string, 
									success: function(data){
									 			jQuery("#search_results").show();
												jQuery("#search_results").html(data);
												jQuery("#PageSearch").removeClass("loading");
									}});
								};
				
	jQuery("#PageSearch").bind("keyup", function(ev){
		var searchString = this.value.replace(/^\s+|\s+$/g, "");
		if(searchString != '' && searchString.length > 1){
			jQuery(this).addClass("loading");
			delay(function(){
		    	callbackToPageSearch(searchString);
			}, 200 ); 
		}else{
			jQuery("#search_results").hide()
			jQuery(this).removeClass("loading");				
		}
	});
	jQuery('.page-search').bind("submit", function(ev){
		ev.preventDefault()
		return false
	})
</script>
