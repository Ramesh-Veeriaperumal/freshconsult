<%if(current_account.features?(:chat) && current_account.chat_setting && !(is_assumed_user?))
    comm_url = ChatConfig['communication_url'][Rails.env]
    chat_debug = ChatConfig['chat_debug'][Rails.env]
%>
<div id="freshchat_layout"></div>
  <!-- Chat related contents starts -->
<%= include_cloudfront_css :chat %>
<script src='<%=comm_url%>/socket.io/socket.io.js'></script>
<script src="/javascripts/sound/soundmanager2-jsmin.js"></script>
<script language="javascript">
(function($){
    $(document).ready(function(){
        var requireJS = document.createElement('script');
        requireJS.src = "/javascripts/chat/lib/require/require.js";
        document.body.appendChild(requireJS);

        requireJS.onload=function(){
            var main = document.createElement('script');
            main.src = "/javascripts/chat/main.js";
            document.body.appendChild(main);
        }
    });
})(jQuery);

var CS_URL = "<%=comm_url%>";
var WEB_ROOT = "http://<%=current_account.full_domain%>";
var CHAT_DEBUG = "<%=chat_debug%>";

var USER_LIST = [];
var CURRENT_USER = {
    'id':'<%=current_user.id%>',
    'username':'<%=current_user.name%>'
};

var SITE_ID = '<%=current_account.chat_setting.display_id%>';
var IS_TYPING = '<%=current_account.chat_setting.typing_message%>';
var CHAT_CONSTANTS = <%=ChatSetting::CHAT_CONSTANTS_BY_KEY.to_json.html_safe%>;
var i18n  = { portal_name:'<%=h(current_portal.portal_name)%>',
            title:'<%= t("freshchat.title") %>',
            says:'<%= t("freshchat.says") %>',
            tag_msg:'<%= t("freshchat.tag_msg") %>',
            transfer_to_agent:'<%= t("freshchat.transfer_to_agent") %>',
            block:'<%= t("freshchat.block") %>',
            unblock: '<%= t("freshchat.unblock") %>',
            visitor: '<%= t("freshchat.visitor") %>',
            transfer_agent:'<%= t("freshchat.transfer_agent") %>',
            agent_transfer_msg: '<%= t("freshchat.agent_transfer_msg") %>',
            transfer: '<%= t("freshchat.transfer") %>',
            search_agent: '<%= t("freshchat.search_agent") %>',
            block_visitor:'<%= t("freshchat.block_visitor") %>',
            visitor_details:'<%= t("freshchat.visitor_details") %>',
            visitor_block_msg:'<%= t("freshchat.visitor_block_msg") %>',
            save:'<%= t("freshchat.save") %>',
            cancel:'<%= t("freshchat.cancel") %>',
            enter_tags:'<%= t("freshchat.enter_tags") %>',
            chat_with: '<%= t("freshchat.chat_with") %>',
            ticket_success_msg: '<%= t("freshchat.ticket_success_msg") %>',
            ticket_error_msg: '<%= t("freshchat.ticket_error_msg") %>',
            in_conversation:'<%= t("freshchat.in_conversation") %>',
            available_agents:'<%= t("freshchat.available_agents") %>',
            returning_visitors:'<%= t("freshchat.returning_visitors") %>',
            website_visitors_msg:'<%= t("freshchat.website_visitors") %>',
            message_archives:'<%= t("freshchat.message_archives") %>',
            connection_error_msg:'<%= t("freshchat.connection_error_msg") %>',
            connection_success_msg:'<%= t("freshchat.connection_success_msg") %>',
            website_visitors:'<%= t("freshchat.website_visitors") %>',
            filter_by: '<%= t("freshchat.filter_by") %>',
            keyword: '<%= t("freshchat.keyword") %>',
            visitor_location: '<%= t("freshchat.visitor_location") %>',
            between: '<%= t("freshchat.between") %>',
            tags: '<%= t("freshchat.tags") %>',
            agent: '<%= t("freshchat.agent") %>',
            back: '<%= t("freshchat.back") %>',
            continue_chat: '<%= t("freshchat.continue_chat") %>',
            select_location: '<%= t("freshchat.select_location") %>',
            visitors_online: '<%= t("freshchat.visitors_online") %>',
            ticket_desc: '<%= t("freshchat.ticket_desc") %>',
            transcript_added_msg: '<%= t("freshchat.transcript_added_msg") %>',
            and: '<%= t("freshchat.and") %>',
            on_: '<%= t("freshchat.on_") %>',
            visitor_disconnect_msg: '<%= t("freshchat.visitor_disconnect_msg") %>',
            last_message: '<%= t("freshchat.last_message") %>',
            typing_message: '<%= t("freshchat.typing_message") %>',
            is_typing_header: '<%= t("freshchat.is_typing_header") %>',
            chat_recent_empty_tip: '<%= t("freshchat.chat_recent_empty_tip") %>',
            add_agent_to_chat: '<%= t("freshchat.add_agent_to_chat") %>',
            accept: '<%= t("freshchat.accept") %>',
            ignore: '<%= t("freshchat.ignore") %>',
            transfer_msg: '<%= t("freshchat.transfer_msg") %>',
            unauthorized_attempt_msg: '<%= t("freshchat.unauthorized_attempt_msg") %>',
            update_success_msg: '<%= t("freshchat.update_success_msg") %>',
            update_error_msg: '<%= t("freshchat.update_error_msg") %>',
            recent_messages: '<%= t("freshchat.recent_messages") %>',
            agents: '<%= t("freshchat.agents") %>',
            convert_to_ticket: '<%= t("freshchat.convert_to_ticket") %>',
            create_ticket_tip: '<%= t("freshchat.create_ticket_tip") %>',
            error: '<%= t("freshchat.error") %>',
            existing_tkt_option_tip: '<%= t("freshchat.existing_tkt_option_tip").html_safe %>',
            select_ticket: '<%= t("freshchat.select_ticket") %>',
            do_not_convert_tkt: '<%= t("freshchat.do_not_convert_tkt") %>',
            go_back: '<%= t("freshchat.go_back") %>',
            id: '<%= t("freshchat.id") %>',
            subject: '<%= t("freshchat.subject") %>',
            requested_by: '<%= t("freshchat.requested_by") %>',
            find_by_id: '<%= t("freshchat.find_by_id") %>',
            find_by_subject: '<%= t("freshchat.find_by_subject") %>',
            find_by_requester: '<%= t("freshchat.find_by_requester") %>',
            info_msg: '<%= t("freshchat.info_msg") %>',
            join_chat: '<%= t("freshchat.join_chat") %>',
            chatting_with: '<%= t("freshchat.chatting_with") %>',
            returning_visitor: '<%= t("freshchat.returning_visitor") %>',
            new_visitor: '<%= t("freshchat.new_visitor") %>',
            unknown: '<%= t("freshchat.unknown") %>',
            no_visitors: '<%= t("freshchat.no_visitors") %>',
            no_conversation: '<%= t("freshchat.no_conversation") %>',
            no_return_visitors: '<%= t("freshchat.no_return_visitors") %>',
            tag_placeholder: '<%= t("freshchat.tag_placeholder") %>',
            no_visitors_msg: '<%= t("freshchat.no_visitors_msg") %>',
            options: '<%= t("freshchat.options") %>',
            edit_visitor_details: '<%= t("freshchat.edit_visitor_details") %>',
            new_ticket_tip: '<%= t("freshchat.new_ticket_tip").html_safe %>',
            install_tip: "<%= t('freshchat.install_tip').html_safe %>",
            nochat: "<%= t('freshchat.nochat') %>"
        }
</script>
    <!-- Chat related contents ends -->
<%end%>