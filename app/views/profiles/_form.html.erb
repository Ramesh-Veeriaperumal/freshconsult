<% javascript_tag do %>
  jQuery(document).ready(function(){  
 invokeRedactor('<%= "user_binfo" %>','signature');
    jQuery("#password_confirmation").rules("add", {  
	          equalTo: "#password"
          });   
  });
<% end %>
<% user = @profile %>
<% user = @profile.user unless current_user.customer? %>
 
<% fields_for "users", @profile do |usr| %>
    <%= error_messages_for :user %> 
 	<ul class="ui-form">
		<li>
			<%= label(:user, :name, t("user.full_name") ) %>
				<%= text_field(:user, :name, :class => "text required", :value => user.name )  %>
		</li>
		<li>
			<%= label(:user, :job_title, t("user.title")) %>
			<%= text_field(:user, :job_title, :class => "text", :value => user.job_title ) %>
		</li>	
		<li class="medium">
			<%= label(:user, :email, t("user.email")) %>			
			<%= text_field(:user, :email, :class => "text required email disabled", :id => "email_primary" , :value => user.email , :disabled =>true) %>
			<%= hidden_field(:user, :user_role, :id=>"user_role", :value => user.user_role) %>			
		</li>
		<li class="small">
			<%= label(:user, :phone, t("user.phone_no")) %>	
			<div>
				<label class="overlabel" for="phone_work">Work</label>
				<%= text_field(:user, :phone, :class => "text", :id => "phone_work", :value => user.phone ) %> 
			</div>
			<div>
				<label class="overlabel" for="phone_mobile">Mobile</label>
				<%= text_field(:user, :mobile, :class => "text", :id => "phone_mobile" ,:value => user.mobile  ) %>
			</div>
		</li>
		
		<% if current_user.customer?%>
			<li class="small">
				<%= label(:user, :twitter_id, t("user.twitter_id")) %>
				<%= text_field(:user, :twitter_id, :class => "text" ) %>
			</li>
			<li>
				<%
					company_name = "";
					unless user.customer.nil?
						company_name =  user.customer.name
					end
				%>
				<%= label(:user, :customer, "Company") %>
				<%= text_field(:user, :customer, :class => "text" , :value => company_name, :id => "contact_customer" ) %>
			</li>
		<%end%>
		
			<li>
				<%= render :partial => "/shared/profileavatar", :locals => { :user => user, :type => "edit" } %>
			</li>
			<% if feature?(:multi_timezone) %>
			<li>
				<%= label(:user , :time_zone, t("account.time_zone")) %>			
				<%= time_zone_select (:user, :time_zone, ActiveSupport::TimeZone.all, :default => user.time_zone) %>
			</li>
			<% end %>
			<% if feature?(:multi_language) %>
				<li>
					<%= label(:user, :language, t('account.language')) %>
					<%= select(:user, :language, I18n.available_locales_with_name , {:selected => user.language.to_sym()})%>
				</li>
			<% end %>
		
		<%unless current_user.customer?%>
			<li>
				<%= label(:agent, :signature_html, t("agent.signature")) %>
				<label class="overlabel" for="user_binfo">
					<%=t('agent.add_signature')%> 
				</label>
				<%= text_area(:agent, :signature_html, :class => "text", :id => "user_binfo" , :value =>@profile.signature_value  ) %>			
				<%= hidden_field(:agent, :user_id, :id => "user_id", :value =>@profile.user_id  ) %>
		</li>
		<%end%>
	</ul>
<% end %>
