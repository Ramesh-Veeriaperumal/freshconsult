<h1><%= @page_title = 'Affiliates' %></h1>
<%= link_to('Add a new affiliate', :action => 'new') %>
<br><br>
<h3>Share A Sale</h3>
<table id="affiliates" class="table table-striped table-bordered">
  <tr>
    <th>Name</th>
    <th>Rate</th>
    <th>Commission</th>
    <th>Discount</th>
  </tr>
  <% @shareasale_affiliates.each do |affiliate| %>
    <tr>
      <td><%= link_to("#{affiliate.name} - #{affiliate.token}" , [:admin, affiliate]) %></td>
      <td><%= number_to_percentage(affiliate.rate * 100, :precision => 0) %></td>
      <td><%= number_to_currency(affiliate.fees) %></td>
      <td><%= affiliate.discounts.collect{ 
              |d| d.description }.join(" and ") if affiliate.discounts %></td>
    </tr>
  <% end %>
</table>

<br><br>
<h3>Resellers</h3>
<table id="affiliates" class="table table-striped table-bordered">
  <tr>
    <th>Name</th>
    <th>Rate</th>    
    <th>Discount</th>
  </tr>
  <% @resellers.each do |affiliate| %>
    <tr>
      <td><%= link_to("#{affiliate.name} - #{affiliate.token}" , [:admin, affiliate]) %></td>
      <td><%= number_to_percentage(affiliate.rate * 100, :precision => 0) %></td>      
      <td><%= affiliate.discounts.collect{ 
              |d| d.description }.join(" and ") if affiliate.discounts %></td>
    </tr>
  <% end %>
</table>

<br><br>
<h3>Others</h3>
<table id="affiliates" class="table table-striped table-bordered">
  <tr>
    <th>Name</th>
    <th>Rate</th>    
    <th>Discount</th>
  </tr>
  <% @others.each do |affiliate| %>
    <tr>
      <td><%= link_to("#{affiliate.name} - #{affiliate.token}" , [:admin, affiliate]) %></td>
      <td><%= number_to_percentage(affiliate.rate * 100, :precision => 0) %></td>      
      <td><%= affiliate.discounts.collect{ 
              |d| d.description }.join(" and ") if affiliate.discounts %></td>
    </tr>
  <% end %>
</table>

