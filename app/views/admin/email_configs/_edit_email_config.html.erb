<% form_for :email_config, @email_config, :url => admin_email_config_path, :html => { :method => :put } do |f| %>
<%= f.error_messages %>
<h3 class="title"><%=t('email_configs.title')%></h3>
<ul class="ui-form">
	<li>
			<label><%=t('email_configs.name')%></label>
			<%= f.text_field :name, :class => "text" %>
	</li>
	<li>	
			<label><%=t('email_configs.reply_email') + " *"%></label>
			<div class="info-data"><%= t('email_configs.info7') %> </div>
			<%= f.text_field :reply_email, :class => "required text", :id => "reply_to_id" %>
	</li>
	<li>	
			<label><%=t('email_configs.info8')%></label>
			<%= content_tag(:div, @email_config.to_email, :id => "div_reply_email", :class =>"highlight-textbox-info" )  %>
			<%= f.hidden_field :to_email, :id => "hidden_reply_to" %>
	</li>
	<li>
			<label><%=t('email_configs.info9')%></label>
			<div class="info-data"><%=t('email_configs.info10')%> </div>
			<%= collection_select(:email_config, :group_id, @groups, :id, :name, options = {:include_blank => "..."}) %>
	</li> 
	<% if feature?(:multi_product)  && !@products.empty? %> 
		<li>
			<label><%=t('email_configs.assign_to_product_msg')%></label>
			<div class="info-data"><p><%=t('email_configs.assign_to_product_info', :products_path => admin_products_path)%></p></div> 
			<%= collection_select(:email_config, :product_id, @products, :id, :name, options = {:include_blank => "..."}) %>
		</li> 
	<% end %>	
</ul>

<div class="button-container">
	<%= f.submit t('save'), :class => "uiButton"  %>
	<%= link_to(t('cancel'), admin_email_configs_path, :class => "uiButton", :id => "email-form-cancel" )  %>
</div> 
<% end %>

<% content_for :pagefixed do -%>
  <% javascript_tag do %>
    jQuery(document).ready(function(){
      jQuery("#reply_to_id")
        .bind("change keyup", 
          function(ev){
            if(this.value != ''){
              reply_email = construct_reply_url(this.value, "<%= current_account.full_domain %>");
              jQuery("#div_reply_email").text(reply_email);
              jQuery("#hidden_reply_to").val(reply_email);
            }
        })
        .trigger("change");        
    });
  <%- end %>
<%- end %>
