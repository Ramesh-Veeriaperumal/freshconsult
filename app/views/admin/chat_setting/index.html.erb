<% @page_title = t('chatwidget_title') %>
<%= include_cloudfront_css :pattern %>
<%= include_cloudfront_js :pattern %>
<% content_for :helpcard do -%>
<%= render :partial => "helpnote" %>
<%- end %>
<div class="chat-header">
	<h3 class = "lead"> <%=t('chatwidget_title')%>
		<div class="pull-right">
			<%= check_box_tag :chat_enable, 1, feature?(:chat_enable), 
				:rel => "toggle", 
				"data-checked-label" => "enabled", 
				"data-unchecked-label" => "disabled",
				:onchange => remote_function( :url => toggle_admin_chat_setting_path, 
											  :complete => "jQuery('#chat_setting').toggle();jQuery('#chat_intro').toggle();") 
			%>
		</div>
	</h3>
</div>
<div id = "chat_setting" class="tabbable" <% unless feature?(:chat_enable) %>style="display:none"<%end%>>
  <ul class="nav nav-tabs">
   <li class="active"><a href="#widget" data-toggle="tab"><%=t('freshchat.widget')%></a></li>
   <li id="chat_settings_install"><a href="#install" data-toggle="tab"><%=t('freshchat.installation')%></a></li>
  </ul>

  <div class="tab-content" id="chat_settings_tab">
    <div class="tab-pane active" id="widget">
      <div class="chat-window-left ui-form clearfix">
		<div class="ui-form">
			<ul>
				<li>
					<%= content_tag(:h3, t('freshchat.custom_chat_window'), :class => "title" ) %> 
				</li>
			</ul>
			<% form_for "chat_settings", "", :html => { :id => "chat_settings_form" } do |f| %>
			<% chat_color = (@chat.preferences != nil)? @chat.preferences['window_color'] : "#777777"; %>

			<div class="span5 marLeftNone">
				<ul>
			      	<li class="inline-field window-bgcolor">
				  	<%= content_tag(:label, t('freshchat.chatbox_bgcolor'), :class => "caption" ) %>
					<div class="fields">
						<div class="color">
							<%= f.color_picker_tag(:class => "color_field required", 
									:id => "window_color", :value => chat_color, :name => "window_color") %>
							<label id="window_color_error" generated="true" class="error" style="display:none;">
								<%=t('freshchat.valid_code')%>
							</label>
						</div>
					</div>
				  	</li>
			  	</ul>
				<ul class="window-position chat-top-space">
					<li class="inline-field">
					  	<label class="caption"><%=t('freshchat.window_position')%></label> 
						<div class="fields">
							<label><select name="window_position" class="valid" id="window_position"></select></label>
						</div>
				  	</li>
				</ul>
				<ul class="window-position chat-top-space">
					<li class="inline-field">
					  	<label class="caption"><%=t('freshchat.window_offset')%></label> 
						<div class="fields">
							<label><input type="text" placeholder="40" name="window_offset" id="window_offset" value="<%=(@chat.preferences != nil)? @chat.preferences['window_offset'] : "40"%>"><span class="sublabel">px</span>
							</label>
							<label id="window_offset_error_msg" class="error" style="display:none;"><%=t('freshchat.window_offset_error_msg')%></label>
						</div>
				  	</li>
				</ul>
			</div>
			<div class="span4 pull-right">
				<div id="chat_layout" class="pull-right">
				  <div id="fc-header" class="chat_fc_header" style="background-color:<%=chat_color%>">
				    <%=(@chat.maximized_title != "")? @chat.maximized_title : t('freshchat.maximized_title')%>
				    <span id="symbol"><i class="icon-caret-down"></i></span>
				  </div>
				  <div id="chat-container" style="display: block;background-color:<%=chat_color%>">
				    <div id="chatwindow">
				      <div id="messagewindow" style="border: 1px <%=chat_color%> solid;">
				        <p class="self clearfix">
				         <img src="/images/fillers/profile_blank_thumb.gif" alt="Profile Image">
				          <span class="msg-block">
				            <b><%=t('freshchat.me')%></b>
				            <span class="time">17:15</span>
				            <span class="msg"><%=t('freshchat.welcome_message')%></span>
				          </span>
				        </p>
				      </div>
				      <textarea placeholder="Your message" id="inputcontainer" disabled></textarea>
				    </div>
				  </div>
			    </div>
			</div>
		</div>
				<ul class="ui-form">	
				  <li class="inline-field">
				  	 <h3 class="title space_bottom"><%=t('freshchat.set_default_msgs')%></h3> 
					 <label class="caption"><%=t('freshchat.minimize_chat_title')%></label>
					 <div class="fields">
					 	<input type="text" class="text" size="18" name="minimized_title" id="minimized_title" value="<%=(@chat.minimized_title != nil)? @chat.minimized_title : t('freshchat.minimized_title')%>" placeholder="<%=t('freshchat.minimized_title')%>">
					 </div>
				  </li>

				  <li class="inline-field">
					 <label class="caption"><%=t('freshchat.maximize_chat_title')%></label>
					 <div class="fields">
					 	<input type="text" class="text" size="18" id="maximized_title" name="maximized_title" value="<%=(@chat.maximized_title != nil)? @chat.maximized_title : t('freshchat.maximized_title')%>" placeholder="<%=t('freshchat.maximized_title')%>">
					 </div>
				  </li>

				  <li class="inline-field">
					<label class="caption"><%=t('freshchat.welcome')%></label>
					<div class="fields">
						<input type="text" class="text" id="welcome_message" name="welcome_message" size="18" value="<%=(@chat.welcome_message != nil)? @chat.welcome_message : t('freshchat.welcome_message')%>" placeholder="<%=t('freshchat.welcome_message')%>" >
					</div>
				  </li>

				  <li class="inline-field">
					<label class="caption"><%=t('freshchat.thank_title')%></label>
					<div class="fields">
						<input type="text" class="text" id="thank_message" name="thank_message" size="18" value="<%=(@chat.thank_message != nil)? @chat.thank_message : t('freshchat.thank_message')%>" placeholder="<%=t('freshchat.thank_message')%>" >
					</div>
				  </li>

				  <li class="inline-field">
					 <label class="caption"><%=t('freshchat.wait_title')%></label>
					 <div class="fields">
					 	<input type="text" class="text" size="18" id="wait_message" name="wait_message" value="<%=(@chat.wait_message != nil)? @chat.wait_message : t('freshchat.wait_message')%>" placeholder="<%=t('freshchat.wait_message')%>">
					 </div>
				  </li>

				  <li class="inline-field">
					<label class="caption"><%=t('freshchat.is_typing_header').html_safe%></label>
					<div class="fields">
						<input type="text" class="text" id="typing_message" name="typing_message" size="18" value="<%=(@chat.typing_message != nil)? @chat.typing_message : t('freshchat.typing_message')%>" placeholder="<%=t('freshchat.typing_message')%>" >
					</div>
				  </li>

				  <li class="inline-field">
				  	<h3 class="title space_top"><%= t('freshchat.chat_availability') %></h3> 
					 <div class="fields marginleftnone">
					 	<div class="ff_item">
							  <label class="item-large"> 
							    <div class="fc_title_info"><%= t('freshchat.show_chat_hours_msg') %></div>
					     		<div class="info-data"><%= t('freshchat.show_chat_hours_info') %></div>
							  </label>
						 </div>
					 </div>
				  </li>

				  <li class="inline-field chat_portal_enable_form">
				  	<label class="caption form_divider"><%= t('freshchat.show_chat_hours') %></label>
				  		<div class="fields">
				  			<ul>
				  				<li class="inline-field">
									<label class="item"> 
										<input type="radio" id="chat_anytime" name="show_chat_hours" value="0">
										<span><%=t('freshchat.anytime')%></span>
									</label>
								</li>

								<li class="inline-field">
									<label class="item"> 
										<input type="radio" id="chat_business_hours" name="show_chat_hours" value="1">
										<span>
											<%=t('freshchat.business_hours')%> 
											<% if multiple_business_hours? %>
											<span id="chat_business_options" class="chat_business_options">
												<%= select_tag :business_calendar_id, 
												options_from_collection_for_select(current_account.business_calendar, 
												:id, :name, @chat.business_calendar_id), 
												:class => 'select2 business_calendar_select2' %>
											</span>
											<% end %>
										</span>
									</label>
								</li>
							</ul>
						</div>
				  </li>

				  <li class="inline-field">
				  	<h3 class="title space_top"><%=t('freshchat.support_portal')%><span class='show_on_portal_checkbox'><%= check_box_tag :show_on_portal, 1, :class => 'filter_item' %></span></h3> 
					 <div class="fields marginleftnone">
					 	<div class="ff_item">
							  <label class="item-large"> 
							    <span><%=t('freshchat.portal_desc')%></span>
							  </label>
						 </div>
					 </div>
				  </li>
 
				  <li class="inline-field chat_portal_enable_form">
				  	<label class="caption form_divider"><%=t('freshchat.portal_option_info')%></label>
				  		<div class="fields">
				  			<ul>
				  				<li class="inline-field">
									<label class="item"> 
						  			<input type="radio" id="show_on_portal_all" name = "show_on_portal" value="everyOne" checked><span><%=t('freshchat.everyone')%></span>
									</label>
						  		</li>
						  		<li class="inline-field">
									<label class="item"> 
									<input type="radio" id="portal_login_required" name = "show_on_portal" value="onlyLoggedIn"><span><%=t('freshchat.logged_in_users')%></span>
									</label>
								</li>
							</ul>
						</div>
				  </li>

				  <li class="inline-field">
				  	<h3 class="title space_top"><%=t('freshchat.prechat_title')%><span class='prechat_form_checkbox'><%= check_box_tag :prechat_form, 1, :class => 'filter_item', :id => 'prechat_form' %></span></h3> 
					 <div class="fields marginleftnone">
					 	<div class="ff_item">
							  <label class="item-large"> 
							    <span><%=t('freshchat.prechat_desc')%></span>							     
							  </label>
						 </div>
					 </div>
				  </li>

				  <li class="inline-field prechat_form">
					 <label class="caption"><%=t('freshchat.prechat_msg')%></label>
					 <div class="fields">
					 	<input type="text" class="text" size="18" id="prechat_message" name="prechat_message" value="<%=(@chat.prechat_message != nil)? @chat.prechat_message : t('freshchat.prechat_message')%>" placeholder="<%=t('freshchat.prechat_message')%>">
					 	<div class="info-data"><%=t('freshchat.welcome_tip')%></div>
					 </div>
				  </li>

				  <li class="inline-field prechat_form">
				  	<label class="caption form_divider"><%=t('freshchat.form_details')%></label>
				  	<div class="fields">
					  	<ul>
					  		<li class="inline-field">
								 <label class="caption"><%=t('freshchat.name')%></label>
								 <div class="fields">
								 	<div class="ff_item">
										  <label class="item"> 
										    <input class="filter_item" type="checkbox" checked disabled value=""> 
										    <span><%=t('freshchat.show')%></span>
										  </label>
										  <label class="item"> 
										    <input class="filter_item" type="checkbox" checked disabled value=""> 
										    <span><%=t('freshchat.required')%></span>
										  </label>
									 </div>
								 </div>
							  </li>

							  <li class="inline-field">
								 <label class="caption"><%=t('freshchat.phone')%></label>
								 <div class="fields">
								 	<div class="ff_item">
										  <label class="item"> 
										    <input class="filter_item" id="prechat_phone" type="checkbox" value="<%=ChatSetting::CHAT_CONSTANTS_BY_KEY[:SHOW]%>">
										    <span><%=t('freshchat.show')%></span>
										  </label>
										  <label class="item">
										    <input class="filter_item" id="prechat_phone_req" type="checkbox" value="<%=ChatSetting::CHAT_CONSTANTS_BY_KEY[:REQUIRED]%>"> 
										    <span><%=t('freshchat.required')%></span>
										  </label>
									 </div>
								 </div>
							  </li>

							  <li class="inline-field">
								 <label class="caption"><%=t('freshchat.mail')%></label>
								 <div class="fields">
								 	<div class="ff_item">
										  <label class="item"> 
										    <input class="filter_item" id="prechat_mail" type="checkbox" value="<%=ChatSetting::CHAT_CONSTANTS_BY_KEY[:SHOW]%>">
										    <span><%=t('freshchat.show')%></span>
										  </label>
										  <label class="item"> 
										    <input class="filter_item" id="prechat_mail_req" type="checkbox" value="<%=ChatSetting::CHAT_CONSTANTS_BY_KEY[:REQUIRED]%>"> 
										    <span><%=t('freshchat.required')%></span>
										  </label>
									 </div>
								 </div>
							  </li>
					  	</ul>
				  </div>
				  </li>

				  <li class="inline-field">
				  	<h3 class="title space_top"><%=t('freshchat.proactive_title')%><span class='proactive_chat_checkbox'><%= check_box_tag :proactive_chat,1, :class => 'filter_item', :id => 'proactive_chat' %></span></h3>
					 <div class="fields marginleftnone">
					 	<div class="ff_item"> 
							  <label class="item-large">
							     <div class="fc_title_info"><%=t('freshchat.procative_info')%></div>
							     <div class="info-data"><%=t('freshchat.proactive_note')%></div>
							  </label>
							  <span class="proactive_chat range_slider">
								<%=t('freshchat.proactive_time',:seconds => "<span class='btn-group'>
									  <button type='button' class='btn btn-default dropdown-toggle proactive_time_display' data-toggle='dropdown'></button>	 
									      <ul class='dropdown-menu' role='menu'>
									      <input id='proactive_time' name='proactive_time' type='range' min='15' max='180' step='15' value='' />
									      <span class='range_time_from'>15sec</span> <span class='range_time_to'>3min</span>
									      </ul>
									</span>").html_safe%>
							   </span>
						 </div>
					 </div>
				  </li>
				</ul>
    	</div>
    	<hr>
    	<div class="row-fluid text-right">
    		<a href="/admin/home" class="btn"><%=t('freshchat.cancel')%></a>	
			<input class="btn btn-primary" id="chat_setting_save" name="commit" type="button" value="<%=t('freshchat.save')%>">
		</div>
		<% end %>
  	  </div>
      <div class="tab-pane" id="install">
    	<ul class="ui-form">
			<li class="inline-field">
				<%= content_tag(:h3, t('freshchat.integrate_freshchat_title'), :class => "title" ) %>
				<div class="intro"><%=t('freshchat.integrate_msg')%> 
			</li>

			<li class="code-view">
				<div class="chat_code_copy tooltip" twipsy-content-set="true" data-original-title="<%= t('freshchat.copy_to_clipboard') %>"><span class="icon-copy"></span></div>  
				<textarea id="EmbedCode" readonly></textarea>
				<div class="intro"><%=t('freshchat.integrate_freshchat_info')%>
			</li>
		</ul>		
      </div>
   </div>
</div>
<div id="chat_intro" <% if feature?(:chat_enable) %>style="display:none"<%end%>>
	<%= render :partial => "intro" %>
</div>