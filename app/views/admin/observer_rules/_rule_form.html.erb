<% content_for :sidebar do -%><%- end %>
<%= include_javascripts :observer_event %>
<%= render :partial => "admin/shared/filter_jsinit", :locals => { :filter_type => "observer"} %>


<%= f.error_messages :object_name => 'rule' %>
<input type="hidden" name="id"   value="" />
<input type="hidden" name="type" value="virtual_agents" />
<ul class="ui-form">
	<li>
		<%= f.label :name, "#{t('dispatch.rule_name')} *" %>
		<label class="overlabel" for="va_rule_name"><%= t("example") %>: <em>"<%=t('dispatch.info1')%>"</em> </label>
		<%= f.text_field :name, :class => "required text" %>
	</li>
	<li>
		<%= f.label :description %>				
		<label class="overlabel" for="va_rule_description">
			<%= t("example") %>: <em>"<%=t('dispatch.info2')%>"</em>
		</label>
		<%= f.text_area :description, :class => "smallpara" %>
	</li>
	<li>
		<%= f.label :performed_by, "#{t('admin.observer_rules.performed_by')}" %>
		<div class="choicelist">
			<label><%=t('dispatch.info3')%>?</label>
			<%= f.radio_button  :performed_by, 'agent', :class => "radio" %> <%= f.label :agent, t('admin.observer_rules.agent'), :class => "radiolabel" %>
			<%= f.radio_button  :performed_by, 'customer', :class => "radio" %> <%= f.label :requester, t('admin.observer_rules.requester'), :class => "radiolabel" %>
			<%= f.radio_button  :performed_by, 'anyone', :class => "radio" %> <%= f.label :anyone, t('admin.observer_rules.anyone'), :class => "radiolabel" %>
		</div>
		
		<%= f.select :performed_by, options_for_select((@agents.map {|k, v| [v, k.to_s]}), @va_rule.performed_by ), {}, { :multiple => true, :class => "customSelect" } %>
	</li>
	
	<li>
		<div class="choicelist">
			<label><%=t('dispatch.info4')%>?</label>
		</div>
		<div class="conditionset" id="eventDOM">
		<div id="EventList" class="rule_list"></div>
		<fieldset class="addchoice">
	   		<p><%=t('admin.observer_rules.add_new_event')%></p> <img alt="<%=t('admin.observer_rules.add_new_event')%>" class="add" src="/images/add.png" />
	  </fieldset>			
		</div>
	</li>
	<li>			
		<div class="choicelist">
			<label><%=t('dispatch.info3')%>?</label>
			<%= f.radio_button  :match_type, 'any', :class => "radio" %> <%= f.label :match_type_any, t('dispatch.match_any'), :class => "radiolabel" %>
			<%= f.radio_button  :match_type, 'all', :class => "radio" %> <%= f.label :match_type_all, t('dispatch.match_all'), :class => "radiolabel" %>
		</div>			
		<div class="conditionset" id="filterDOM">
		<div id="RuleList" class="rule_list"></div>
		<fieldset class="addchoice">
	      <p><%=t('dispatch.add_condition')%></p> <img alt="<%=t('dispatch.add_new_choice')%>" class="add" src="/images/add.png" />
	  </fieldset>			
		</div>
	</li>
	<li>
		<label><%=t('dispatch.act_to_perform')%>?</label>				
		<div class="conditionset" id="actionDOM">
			<div id="ActionList" class="rule_list"></div>
			<fieldset class="addchoice">
	        <p><%=t('dispatch.add_new_action')%></p> <img alt="<%=t('dispatch.add_new_action')%>" class="add" src="/images/add.png" />
	   	</fieldset>		
		</div>
	</li>
</ul>		
<br />
<div class="button-container">
	<input type="hidden" name="save_json" id="savejson" value="" />
	<input type="submit" class="uiButton" id="dispatchr_submit" value="<%=t('save')%>" />
	<%= link_to t('cancel'), {:action => 'index'}, :class => "uiButton" %>
</div>

<% content_for :pagefixed do %>
	<%= render :partial => "/shared/placeholder_help" %>
<% end %>

