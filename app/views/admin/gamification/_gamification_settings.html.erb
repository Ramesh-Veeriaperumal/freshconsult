<div>
    <%= form_tag update_game_admin_gamification_index_path, :method => :put, :id => "scoreboard_ratings_form", :rel => "validate", :class => "form-horizontal" do %>
        <h5 class="lead"><%= t('admin.gamification.gamification_settings.award_points') %></h5>
        <div class="control-group">
            <label class="control-label">
                <%= t('admin.gamification.gamification_settings.agent_resolves_ticket').html_safe %>
            </label>
            <div class="controls">
                <div class="row-fluid">
                    <% @scoreboard_ratings.each_with_index do |scoreboard , index| %>
                        <%if scoreboard.resolution_speed < 100 %>
                            <%= fields_for "scoreboard_ratings[#{index}]", scoreboard do |sb| %>
                                <div class="span3">
                                    <label class="label-title"> <%= t(".#{h(scoreboard.resolution_name)}").html_safe %> </label>
                                    <%= sb.text_field :score, :value => scoreboard.score, :class => "number points alignright required", :maxlength => "5" %>
                                    <span class="info_data">Pts</span>
                                    <%= sb.hidden_field :resolution_speed, :value => scoreboard.resolution_speed %>
                                    <%= sb.hidden_field :id, :value => scoreboard.id %>
                                </div>
                            <% end %>
                        <% end %>
                    <% end %>
                </div>
            </div>
        </div>
        <br/>
        <div class="control-group">
            <label class="control-label">
                <%= t('admin.gamification.gamification_settings.bonus_points_for') %>
            </label>
            <div class="controls">
                <div class="row-fluid">
                    <% @scoreboard_ratings.each_with_index do |scoreboard , index| %>
                        <%if scoreboard.resolution_speed > 100 %>
                            <%= fields_for "scoreboard_ratings[#{index}]", scoreboard do |sb| %>
                                <div class="span3"> 
                                    <label class="label-title"><%= t(".#{scoreboard.resolution_name}") %> </label>
                                    <%= sb.text_field :score, :value => scoreboard.score, :class => "number points alignright required", :maxlength => "5" %>
                                    <span class="info_data">Pts</span>
                                    <%= sb.hidden_field :resolution_speed, :value => scoreboard.resolution_speed %>
                                    <%= sb.hidden_field :id, :value => scoreboard.id %>
                                </div>
                            <% end %>
                        <% end %>
                    <% end %>
                </div>
            </div>
        </div>
        <h5 class="lead"><%= t('.title_levels')%></h5>
        <p class="lead-desc muted"><%= t('.info_levels') %></p>
        <div class="row-fluid">
            <% @scoreboard_levels.each_with_index do |level , index| %>
                <%= fields_for "scoreboard_levels[#{index}]", level do |sl| %>
                <div class="span2">
                    <label class="label-title"><%= level.name %></label>
                    <%= sl.text_field :points, :value => level.points, :maxlength => "9", 
                            :class => "number points required #{ 'level' if (index > 0) }" %></td>
                    <%= sl.hidden_field :id, :value => level.id %>
                </div>
                <% end %>
            <% end %>        
        </div>
        <br/>
        <div class="button-container">        
            <a class="btn" href="/admin/home"><%= t('cancel') %></a>
            <%= submit_tag t('account.save'), :class => 'btn btn-primary' %>
        </div>
    <% end %>
</div>
<div id="all-agents-gamification-reset" class="hide">
  <p class="margin-bottom"><br/> <%= t('admin.gamification.reset_arcade_alert', :points => current_account.scoreboard_levels.least_points.first.points) %></p>
</div>


<% content_for :onload_script do %>
    jQuery.validator.addMethod("level", function(value, element, param) {
    console.log(element);
        _array = element.id.split("_");
        _array[2] = parseInt(_array[2]) - 1;
        prev_val = parseInt(jQuery("#" + _array.join("_")).val());
        current_val = parseInt(value);
        
        return (prev_val < current_val);
    }, "This should be greater than its previous level");

    jQuery.validator.addClassRules("level", { level: true });

<% end %>