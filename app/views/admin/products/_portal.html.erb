<% content_for :onload_script do %>
	/* jQuery("#PortalUrl")
		.rules("add", {
	  			required: function(element) { return ((!!jQuery("input[@id=EnablePortal]:checked").length)); }
	   }); */
<% end %>
<% javascript_tag do %>
  jQuery(document).ready(function(){ 
    jQuery("#PortalUrl").blur(function(){
      input_url = jQuery('#PortalUrl').val();
      protocol_exists = !(input_url.indexOf('http://') && input_url.indexOf('https://'));
      if(protocol_exists)
      {
        get_index = input_url.indexOf("://");
        result_url = input_url.substring(get_index+3);
        jQuery('#PortalUrl').val(result_url);
      }
    });
  }); 
<% end %>
<div class="portal-settings">
  <br />
  <div class="largelabel">
    <%= content_tag(:label, t('.portal_settings'), :class => "tabbed caption") %>
  </div>

  <div class="fields">
    <%= content_tag(:label, t('.portal_url') + "*") %>
  	<%= portal.text_field :portal_url, :class => "text url_without_protocol", :id => "PortalUrl" %>
  	<%= content_tag(:div, t('.cname_configure_info', :full_domain => current_account.full_domain), :class => "info-data") %>
  	<span class="seperator"></span>

    <%= content_tag(:label, t('.portal_name')) %>
  	<%= portal.text_field :name, :class => "text" %>
  	<%= content_tag(:div, t('.portal_name_info'), :class => "info-data") %>
  	<span class="seperator"></span>
  	
  	<!-- locale starts here-->
  	 <% if feature?(:multi_language) %>
  	  <%= content_tag(:label, t('.portal_language')) %>
  		<%= portal.select :language, I18n.available_locales_with_name , {:selected =>  (!@product.portal.blank?) ? @product.portal.language.to_sym() : current_portal.language.to_sym() }%>
  		<%= content_tag(:div, t('.portal_language_info'), :class => "info-data") %>
  	<span class="seperator"></span>
  	<% end %>
  	<!-- locale ends here -->

    <label>    
      <%= t(".top_level_forum") %>
      <%= portal.collection_select :forum_category_id, @forums_categories, :id, :name, options = { :prompt =>  t(".select_forum_category")} %>
    </label>
  	<%= content_tag(:div, t('.top_level_forum_info'), :class => "info-data") %>
    <span class="seperator"></span>

    <label>
      <%= t(".top_level_solution") %>    
      <%= portal.collection_select :solution_category_id, @solution_categories.reject(&:is_default?), :id, :name, options ={:prompt => t(".select_solution_category")} %>
    </label>
    <%= content_tag(:div, t('.top_level_solution_info'), :class => "info-data") %>
  </div>

  <span class="big-seperator"></span>
  <div class="largelabel">
    <%= content_tag(:label, t('.portal_rebranding'), :class => "tabbed caption") %>
  </div>

  <div class="fields">
    <%= render :partial => "/shared/logo_image", :locals => { :item => @product.portal, :field_name => "product[portal_attributes]" } %>
    <div class="fields">
      <span class="seperator"></span>
      <label class="overlabel" for="link_back_text"><%= t("linkback_overlabel") %></label>
      <input name="product[portal_attributes][preferences][logo_link]" id="link_back_text" value="<%=(@product.portal[:preferences]||[]).fetch(:logo_link, '')%>" class="text url" size="30" />
      <div class="info-data">
        <%= t("linkback_info") %>
      </div>
    </div>
    <span class="seperator"></span>  
    <%= render :partial => "/shared/fav_image", :locals => { :item => @product.portal, :field_name => "product[portal_attributes]" } %>
    
  </div>
</div>