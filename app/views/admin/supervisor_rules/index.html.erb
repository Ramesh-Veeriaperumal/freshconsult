<% content_for :helpcard do %>
  <%= render :partial => "helpnote" %>
<% end %>
<div id="cust-list" class="list-page">
  <div class="list-page-header" >
    <div class="row-fluid">
      <div class="span6"><h3 class="title"><%=t('admin.supervisor_rules.index.title')%></h3></div>
       <div class="span6 pull-right pagination-right header_buttons align-right" >
        <%= link_to t('reorder'),'#', :id => "va_rules_reorder_button", :class => "btn" if(@va_rules.active.size > 1) %>
        <%= link_to t('dispatch.new_rule'), new_admin_supervisor_rule_path, :class => "btn btn-primary" %>

      </div>
    </div>
  </div>

  <div>
  <%= render :partial => "/shared/reorder_list", :locals => { 
      :items => @va_rules.active,  
      :action_url => reorder_admin_supervisor_rules_path, 
      :title => :name, :container_id => "va_rules_sort", 
      :reorder_id => "va_rules_reorder_button", :list_id => "va_rules_list"} %>
  </div>
  <div class="row-fluid list-page-subheader">
    <span class="vertical-alignment">
      <i class="ficon-arrow-down-2 fsize-18"></i>
    </span>
    <span class="vertical-alignment"><%= t('admin.supervisor_rules.new_info_help').html_safe %></span>
  </div>

  <div class="list-page-body va_rule-index" id="va_rules_list">
    <table class="table table-striped">
      
      <% (@va_rules.active + @va_rules.inactive).each do |va_rule| %>
        <tr id=<%= dom_id(va_rule) %>>
          <td  <%= "class='va_rule_disabled custom-tip' data-tip-classes = 'va-rule-index-tooltip' title='#{t('admin.va_rules.disabled')}'".html_safe if va_rule.any_restricted_actions? %>>
            <%= form_for va_rule, :url => activate_deactivate_admin_supervisor_rule_path(va_rule) do |f| %>
              <%= f.check_box :active, va_rule_checkbox_options(va_rule), true, false %>
            <% end %>
          </td>
          <td>
            <strong>
              <%= link_to(h(va_rule.name), edit_admin_supervisor_rule_path(va_rule), va_rule_link_options(va_rule)) %>
            </strong><br/>
            <span class="muted"><%= h va_rule.description %></span>
          </td>
          <td>
          <% if !va_rule.any_restricted_actions? %>
            <div class="item_actions" align="right">
              <%= link_to(t('clone'), clone_rule_admin_supervisor_rule_path(va_rule), :class => "btn btn-mini")%>
              <%= link_to(t('edit'), edit_admin_supervisor_rule_path(va_rule), :class => "btn btn-mini") %>
              <%= link_to "<i class='icon-trash'></i>".html_safe, admin_supervisor_rule_path(va_rule), :confirm => t('confirm_delete_message', :human_name => t('.human_name')), :method => :delete, :class => "btn btn-mini" %>

            </div>
          <% end %>
          </td>
        </tr>
      <% end %>

    </table>  
  </div>

</div>

<%= javascript_tag do %>
  (function($){
     var show_sandbox_notification = <%= show_sandbox_notification %>
     var notification_message = '<%=t("sandbox.sandbox_notification_for_rules").html_safe %>';
     if(show_sandbox_notification && jQuery('#va_rules_list table tbody tr').length >= 10){
             jQuery("#noticeajax").html(notification_message).show();
             closeableFlash('#noticeajax');
     }
    $('.activate').itoggle({
      checkedLabel: "<%= t('plain_on') %>",
      uncheckedLabel: "<%= t('plain_off') %>"
    }).change(function() {
      $(this).parent().submit();  
    });
  })(jQuery)
<% end %>
