<!--Copyright © 2014 Freshdesk Inc. All Rights Reserved.-->
<% form_tag(export_csv_reports_freshfone_summary_reports_url, { :method => :post, :id => 'report_filters' }) do %>
<ul class="unstyled">

<li>
  <h3 class="lead"><%= t('reports.freshfone.filter_report') %>
    <span class="muted report-close pull-right" id="filter-close-icon">×</span>
  </h3>
  </li>
  <li>
     <%date_range = @report_date.blank? ? "#{30.days.ago.strftime("%d %B %Y")} - #{1.days.ago.strftime("%d %B %Y")}" :  @report_date
      %>
      <label class="control-label"><%= t('reports.select_time_period').html_safe%></label>
      <%= text_field_tag :date_range, date_range, :class => "required input-large" %>
  </li>
  <li>
    <label class="control-label"><%=t('reports.freshfone.number')%></label>  
    <%= select_tag :freshfone_number, 
     grouped_options_for_select(
              [
                ["", [[t('reports.freshfone.all_numbers'), Reports::FreshfoneReport::ALL_NUMBERS.to_i]]],
                [" ", freshfone_numbers.collect{ |c| [c.number_name,c.id] }.reverse]
              ], @freshfone_number.to_i).html_safe,
          { :multiple => false, :"data-minimum-results-for-search" => "3",
              :class => "select2 filter_item", "data-dropdown-css-class" => "ff-select2-dropdown-pl",
              "data-placeholder".to_sym() => t('reports.freshfone.select_number')
            }  %>
  </li>
  <li>
      <label class="control-label"><%=t('reports.freshfone.group')%></label>  

      <input type="hidden" id='group_id' name='group_id' class = "select2 filter_item"/>

      <label class="control-label"><%=t('reports.freshfone.call_type')%></label>
      <%= select_tag :call_type, options_for_select(call_types,@call_type.to_i), 
              { :multiple => false, 
                :class => "select2 filter_item",
                      "data-placeholder".to_sym() => t('reports.freshfone.select_call_type')} %>
  </li> 
    <li>
      <br/>
      <a class="btn btn-primary" id="submit" href="javascript:void(0)"><%=t('reports.freshfone.generate_summary')%></a>
      <a class="btn" id="cancel" href="javascript:void(0)"><%=t('reports.freshfone.filter_close')%></a>
      <%= submit_tag "Generate PDF", :class => "hide", :id => "generate-pdf" %>
    </li>
  </ul>
<% end %>
<% javascript_tag do %>
jQuery(document).ready(function() {
 jQuery("#date_range").daterangepicker({
    latestDate: new Date(),
    presetRanges: [
      {text: '<%= t('reports.date_ranges.last_7_days') %>', dateStart: 'Today-8', dateEnd: 'Today-1' },
      {text: '<%= t('reports.date_ranges.last_30_days') %>',dateStart: 'Today-31', dateEnd: 'Today-1'},
      {text: '<%= t('reports.date_ranges.last_90_days') %>',dateStart: 'Today-91',  dateEnd: 'Today-1'}
    ],
    presets: {
      dateRange: '<%= t('reports.date_ranges.custom') %>'
    },
    dateFormat: getDateFormat('datepicker'),
    closeOnSelect: true,
    earliestDate: Date.parse('t - 6 m'),
    rangeDurationMonths: parseInt('<%=Reports::FreshfoneReport::MAX_ALLOWED_MONTHS%>')
  });
  

  jQuery("#date_range").bind('keypress keyup keydown', function(ev) {
    ev.preventDefault();
    return false;
  });
 });
<% end %>