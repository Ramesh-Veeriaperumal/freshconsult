<div class="customer-report"> 
	<div class="customer-chart-wrapper" id="customer_report_chart_wrapper">
		<div class="loading-bar hide">
			<div class="loading-box" id="loading-box"> 
				<div class="reports-loading sloading loading-small loading-left repo generate-hd-reports"><%=t('helpdesk_reports.loading_text') %></div> 
			</div>
		</div>
		<div class="customer-chart" id="customer_report_main"></div>
	</div>
	
</div>

<script type="text/javascript">
	jQuery(document).ready(function () {
	    var locals = HelpdeskReports.locals;
	    locals.chart_hash = <%= @data.to_json.html_safe %>;
	    var last_dump_time = <%= @last_dump_time ? t('helpdesk_reports.last_updated',{last_dump_time: @last_dump_time}).to_json.html_safe : false %>
	    
	    var err = <%= @filter_err ? @filter_err.to_json.html_safe : false %>;

	    if (err) {
	    	var div = ["reports_container"];
	        HelpdeskReports.CoreUtil.populateEmptyChart(div, err);
	    } else {
	    	HelpdeskReports.ChartsInitializer.CustomerReport.init(locals.chart_hash);
	    }
	    if (last_dump_time){
        	jQuery("#last-updated").html(last_dump_time);	
        	jQuery(".reports-title").addClass('updated-time')
        } else{
        	jQuery(".reports-title").removeClass('updated-time')
        }


	});
</script>