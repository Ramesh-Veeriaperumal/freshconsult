
<% form_tag({:action => :export_csv}, { :method => :post, :id => 'report_filters' }) do %>

	<div>
	 <%= collection_select({}, :customer_id, current_account.customers, :id, :name, { :include_blank => '...', :selected => @customer_id })%>
	 <%= collection_select({}, :user_id, current_account.users.technicians, :id, :name, { :include_blank => '...', :selected => @user_id })%>
	 <%= select({}, :billable , Helpdesk::TimeSheet::BILLABLE_HASH ,{ :include_blank => '...' , :selected => (@billable.eql?([true,false]) ? "" : @billable)} )%>
	 <%=select_month(Time.utc(Time.now.year, @month, 1) || Date.today)%>
	
	</div>

	<div class="button-container">
    	<%= submit_tag "Export to CSV", :class => "uiButton", :id => "ExportToCSV" %>
	</div>
<% end %>

<div id="time_sheet_report" >
	<%= render :partial => "time_sheet_list", :locals => {:time_sheets => @time_sheets}%> 
</div>

<% javascript_tag do %> 
jQuery(document).ready(function(){
  jQuery("#report_filters").change(function(){
    jQuery("#time_sheet_report").html("<div class='loading-box'></div>"); 
    jQuery.ajax({
        url: "/reports/timesheet_reports/report_filter",
        type: "POST",
        data: jQuery(this).serializeArray(),
        success: function(data){ 
		   jQuery("#time_sheet_report").hide().html(data).fadeIn(300);
        }
		});
      }); 	  
  });

<% end %>