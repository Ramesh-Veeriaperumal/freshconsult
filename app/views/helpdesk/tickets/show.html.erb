<%= include_cloudfront_rtl_css :tkt_details_print, :media => "print"  %>
<%= render :partial => "helpdesk/tickets/show/scriptvars.html.erb" %>
<%= load_sticky %>
<div class="tkt-wrapper ticket_show" data-showing='notes'>
	<div class="tkt-wrapper-inner clearfix">

		<%# render :partial => "helpdesk/tickets/show/info.html.erb" %>
		<div id="forFixed" class="conversation_thread"></div>
		<div id="tkt-inner" class="scollable_content clearfix" >

			<% unless params[:format] == 'widget' %>
				<%= render :partial => "helpdesk/tickets/show/sidebar.html.erb" %>
			<% end %>
			<!--content Left-->
			<div class="leftcontent">
				<div class="conversation_thread" id="original_request">
					<div class="conversation">
						<%= render :partial => "helpdesk/tickets/show/original_request.html.erb" %> 
					</div>
				</div>
				<div class="conversation_thread hide" id="show_more">
					<div class="conversation">
						<a href="" class="avatar-wrap avatar-wrap-collapse"><p>
							<span class='count_number not_on_loading' rel='count-total-remaining'></span>
							<span class='count_number loading_only'>...</span>
							<span rel='count_more' class="count_more not_on_loading"><%= t('more') %></span>
						</p></a>
						<a href="" class="commentbox commentbox-blue">
							<div><%= t('ticket.expand') %></div>
						</a>
					</div>
				</div>
				<%= render :partial => "helpdesk/tickets/show/conversations.html.erb" %> 
				<%= render :partial => "helpdesk/tickets/show/new_conversation.html.erb" %> 
			</div>
		</div>
	</div>
</div>

<%= render :partial => "helpdesk/tickets/show/due_date.html.erb" %>
<% if current_account.features?(:collision) %>
	<%= render :partial => "helpdesk/tickets/freshdesk_socket", :locals => {:ticket => @ticket } if current_account.agents_from_cache.count > 1%>
<% end %>


<script type="text/javascript">
	scriptLoader.load('360player');
jQuery(document).ready(function(){
	jQuery('div.attach-error').parents('.commentbox').find('.seperator').addClass('overlapping');
	jQuery(".search_field_item input").keypress(function(event) { return event.keyCode != 13; });
});
try {
	freshfonePlayerSettings();
} catch(e) {console.log("freshfonePlayerSettings not loaded");}
!function(){
	"use strict";
	Fjax.bodyClass = 'ticket_details';
	Fjax.current_page = 'ticket_detail';
	TICKET_DETAILS_DOMREADY();
	Fjax.afterNextPage = TICKET_DETAILS_CLEANUP;
	<% if @ticket.is_twitter? %>
	jQuery(document).ready(function(){
		jQuery('#twitter_handle').change();
	});
	<% end %>
	<% unless @draft.nil? %>
		swapEmailNote('cnt-reply', null);
		TICKET_DETAILS_DATA['draft']['hasChanged'] = false;
		jQuery(window).trigger('scroll');
	<% end %>

		jQuery('#revert_details_view #switch').on('click.ticket_details',function(ev) {
			ev.preventDefault();;
			setCookie('new_details_view', 'false', 90, '/');
			window.location = '<%= helpdesk_ticket_path(@ticket) %>';
		});
		deleteCookie('new_details_view', '/');
		
		jQuery(".list_agents_replying").addClass("hide");
}()
</script>
<% content_for :layoutType do -%>ticket_details<%- end %>
