<%=will_filter_scripts_tag %>
<% form_tag({}, {:method => :get, :name=>'wf_form', :id => 'wf_form', :class => 'wf_form' }) do %>
	<%= hidden_field_tag(:wf_id, wf_filter.id) %>
<%= hidden_field_tag(:wf_type, wf_filter.class.name) %>
<%= hidden_field_tag(:wf_dirty, "false") %>
<%= hidden_field_tag(:wf_submitted, "false") %>
<%= hidden_field_tag(:wf_name, wf_filter.name) %>
<%= hidden_field_tag(:wf_model, wf_filter.model_class_name) %>
<%= hidden_field_tag(:wf_export_format, "") %>
<%= hidden_field_tag(:wf_export_fields, "") %>
	<% i = 0 %>
	<% wf_filter.definition.each do |k,v| %> 
		<%= hidden_field_tag("wf_c#{i}",k) %>
		<%= hidden_field_tag("wf_o#{i}",v[:operator]) %>
		<%=v[:name]%> 
           <%= render :partial => "/helpdesk/tickets/containers/#{v[:container]}", :locals => {:index => i, :options => v[:options]} %>
	<% i+=1 %>		
	<%end%> 
			<br>
	<span id="wf_loader" class="spinner" style="display:none;"><%=image_tag "/wf/images/spinner.gif", {:style=>"vertical-align:middle"} %> Loading...</span>	
	<%=link_to_function("<span>Submit Filter</span>", "wfFilter.submit()", :class => "wf_grey_button wf_pcb") %>
	<%=link_to_function("<span>Save As New...</span>", "wfFilter.saveFilter()", :class => "wf_grey_button wf_pcb") %>
	   
<% end %>
<% javascript_tag do%>
	jQuery(document).ready(function(){
		jQuery(".view_checkbox")
			.bind("change", function(ev){				
				var hidden_id 		= jQuery(this).attr('data_hidden_id'),
				    hidden_data 	= $(hidden_id),
					array_construct = $A();
					
				jQuery.each(jQuery(this).parent().children(), function(index, item){					
					if(item.checked)
						array_construct.push(item.value)
				});
				
				hidden_data.value = array_construct;
			});	
	});
<% end %>


