<li class="close-dialog">
	<% if params[:tkt_cr].present?
			if @ticket
				id = @ticket.display_id
				tkt = @ticket
				helpdesk = @ticket.account.portal_name
			else
				id,tkt,helpdesk=nil
			end
			title = truncate(Liquid::Template.parse(ca_response.content).render('ticket' => tkt, 'helpdesk_name' => helpdesk), :length => 200)
			function = "GetCannedResponse.init('#{id}','#{ca_response.id}', this)"
		elsif @ticket
			title = truncate(Liquid::Template.parse(ca_response.content).render('ticket' => @ticket, 'helpdesk_name' => @ticket.account.portal_name), :length => 200)
			function = "getCannedResponse('#{@ticket.display_id}','#{ca_response.id}', this)"
		else
			title = truncate(ca_response.content, :length => 200)
			function = "getCannedResponse('#{ca_response.id}', this)"
		end
      title = title.gsub('&lt;', '&amp;lt;')
      #Double escaping tags that are part of the text
    %>
  <%= link_to_function ("<span id='resp-icon'></span><span id='resp-text'>"+ truncate(h(ca_response.title), :length => 50)+"</span>").html_safe, function, :class => "custom-tip-left", "data-tip-classes" => 'ui-tooltip-response',  :title => title, "data-response" => ca_response.id %>
</li>