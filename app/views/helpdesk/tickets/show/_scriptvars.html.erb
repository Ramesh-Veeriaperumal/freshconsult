<script type="text/javascript">
var tag_list = "<%= escape_javascript(@ticket.tags.collect { |tag| tag.name }.join(',').html_safe) %>";
TICKET_DETAILS_DATA = {
	displayId			: "<%= @ticket.display_id %>",
	ticket_path 		: "<%= helpdesk_ticket_path(@ticket) %>",
	total_notes			: "<%= @ticket_notes_total %>",
	notes_per_page		: 50,
	notes_pagination_url: "/helpdesk/tickets/<%= @ticket.display_id %>/notes?v=2&",
	status_refresh_url	: "<%= status_helpdesk_ticket_path(@ticket)%>",
	last_note_id		: <%= @ticket_notes.present? ? @ticket_notes.last.id : -1 %>,
	activities_pagination_url: "/helpdesk/tickets/<%= @ticket.display_id %>/<%= (!Account.current.launched?(:activity_ui_disable) and Account.current.features?(:activity_revamp)) ?  'activitiesv2/?' : 'activities/?'%>",
	last_activity		: -1,
	last_activity_batch  : -1,
	loaded_activities	: 0,
	scroll_to_last		: <%= (@ticket.responder_id == current_user.id).to_s %>,
	fetch_notes_url		: "/helpdesk/tickets/<%= escape_javascript(h(@ticket.display_id)) %>/notes", 
	tag_list			: tag_list.split(","),
	created_on			: new Date("<%= @ticket.created_at.strftime("%B %e, %Y %H:%M") %>"),
	draft				: {
							saving_text		: '<%= "#{t('draft')} #{t('saving_draft')}" %>',
							save_path		: '<%=save_draft_helpdesk_ticket_path%>',
							saved_text		: "<%= "#{t('draft')} #{t('saved_draft')}" %>",
							clear_text		: "<%= t('clear_draft_text') %>",
							clear_path		: '<%=clear_draft_helpdesk_ticket_path%>',
							cleared_flag	: <%= @draft.blank?.to_s %>,
							hasChanged		: false,
							saved 			: <%= @draft.present?.to_s %>,
						},
	attachment_missing_alert: '<%= t("ticket.reply_form.attachment_missing_alert") %>',
	cannot_preview_attachment: '<%= t("ticket.cannot_preview_attachment") %>',
	confirm_navigation: '<%= t("ticket.confirm_navigation") %>',
	download: '<%= t("subscription.download") %>',
	pagination_limit	: <%= ActivityConstants::QUERY_UI_LIMIT %>,
	attachment_missing_alert: '<%= t("ticket.reply_form.attachment_missing_alert") %>',
	ticket_subject: "<%= escape_javascript(@ticket.subject.squish.html_safe) %>",
	ticket_deleted: <%= @ticket.deleted %>,
	ticket_spam: <%= @ticket.spam %>
};
</script>
<textarea id="ticket_draft_default_reply" class="hide"><%= bind_last_conv(@ticket, @signature, false, false) %></textarea>
<script type="text/javascript">
TICKET_DETAILS_DATA['draft']['default_reply'] = document.getElementById('ticket_draft_default_reply').value;
</script>
<script type="text/javascript">
	TICKET_CONSTANTS = {
		statuses: 	{
			resolved 	: 	<%= Helpdesk::Ticketfields::TicketStatus::RESOLVED %>,
			closed 		: 	<%= Helpdesk::Ticketfields::TicketStatus::CLOSED %>,
		}
	}
</script>