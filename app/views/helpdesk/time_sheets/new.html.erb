<%= content_tag :div, :id => "timeentry_add" do %>
  <%= form_for :time_entry, :remote => true,
                   :url => helpdesk_ticket_time_sheets_path(@ticket), 
                   :before => 'if (jQuery("#timeentry_apps_add .app-logo input[type=checkbox]").filter(":checked").parentsUntil("#time_integration").filter(".still_loading").length) return false;',
                   :html => { 
                        :id => "add_new_time_entry", 
                        :class => "timesheet_form ui-form",
                        "data-modal-id" => "new_timeentry"
                    } do |f| %>
    <%= hidden_field(:time_entry, :workable_id , { :value => @ticket.id }  )%>
    <%= render :partial => "form", :object => f, :locals => { :type => :new } %>
  <% end %>
<% end %>

<script type="text/javascript">
  function onAddTimeshowFields() {
    jQuery('#timeentry_apps_add').detach().appendTo('#timeentry_add').show();
    jQuery('.modal.in #time_entry_hhmm').focus();  
  }
    onAddTimeshowFields();
    jQuery("#triggerAddTime").on("click", function(){
       onAddTimeshowFields();
  });
</script>