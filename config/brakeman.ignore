{
  "ignored_warnings": [
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "04eeeee75786a7fac4d9742b48bd3c10c78d1ad1897ecac84566fd861d92f326",
      "message": "Unescaped model attribute",
      "file": "app/views/integrations/hootsuite/home/_ticket.html.erb",
      "line": 32,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"helpdesk.tickets.note.hootsuite_created_on.#{((Unresolved Model).new.conversation.last.kind or \"survey\")}\", :user_name => (Unresolved Model).new.conversation.last.user.name, :note_date => hootsuite_datetime_format((Unresolved Model).new.conversation.last.created_at), :timestamp => (Unresolved Model).new.conversation.last.created_at.to_i)",
      "render_path": [
        {
          "type": "template",
          "name": "integrations/hootsuite/home/index",
          "line": 33,
          "file": "app/views/integrations/hootsuite/home/index.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "integrations/hootsuite/home/_ticket"
      },
      "user_input": "(Unresolved Model).new.conversation",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "064fd728729290fa3f5ebd05147398c864c5ca9600b544dd59f471b69745ecdd",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/admin/freshchat_controller.rb",
      "line": 62,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Freshchat::Account.create(permitted_params)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Admin::FreshchatController",
        "method": "create_item"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "06a8a47bdbac77c4a195b0f0e07826339c9e3f9ba7a41afe73309a41d5f8a14c",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket_state.rb",
      "line": 295,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"INSERT INTO #{stats_table_name} (#{\"account_id,ticket_id,created_at,created_hour,resolved_hour,received_tickets,resolved_tickets,num_of_reopens,assigned_tickets,num_of_reassigns,fcr_tickets,sla_tickets\"}) VALUES(#{account_id},#{ticket_id},\\n      '#{datetime}',NULL,#{(\"\\\\N\" or resolved_at.hour)},0,#{(0 or 1)},#{(0 or ((field_hash[:num_of_reopens].to_i + 1) or 1))},#{(0 or 1)},#{(0 or ((field_hash[:num_of_reassigns].to_i + 1) or 1))},\\n      #{(0 or (1 or 0))},#{(0 or (1 or 0))})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::TicketState",
        "method": "check_and_update_ticket_stats"
      },
      "user_input": "stats_table_name",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "06c2d4934b1ff6d094a06e8eb5e630738122e3c3c8554395edeabd84ec1a8217",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_note.html.erb",
      "line": 162,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"helpdesk.tickets.note.#{(\"last_deleted_info\" or \"last_edited_info\")}\", :user_name => link_to_user(@note_last_modified_user_hash[(Unresolved Model).new.id.to_s]), :note_date => formated_date((Unresolved Model).new.last_modified_timestamp), :timestamp => (Unresolved Model).new.last_modified_timestamp.to_i)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "index",
          "line": 39,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/tickets/show/_conversations.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_note"
      },
      "user_input": "(Unresolved Model).new.last_modified_timestamp",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "08107ad6d5f450e0a458190eea2d31a57b5e333e50799cf871f0cdd0f09cacd6",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/import/zen/forum.rb",
      "line": 137,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Topic.find_by_import_id_and_account_id(Post.parse(post_xml).entry_id, @current_account.id).posts.build(Post.parse(post_xml).to_hash.tap do\n hs.delete(:entry_id)\n end.merge(:user_id => @current_account.all_users.find_by_import_id(Post.parse(post_xml).user_id).id, :forum_id => Topic.find_by_import_id_and_account_id(Post.parse(post_xml).entry_id, @current_account.id).forum_id, :body_html => convert_inline_images(Post.parse(post_xml).body)))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Import::Zen::Forum",
        "method": "save_post"
      },
      "user_input": "Post.parse(post_xml).body",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "08bd7e76335cb8c630cfe8fc972aff2362c07d1b181317f7f9ec1a4d516b93c7",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/reports/timesheet_report.rb",
      "line": 184,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "archive_scoper(@start_date, @end_date).where(\"helpdesk_time_sheets.id <= #{@latest_timesheet_id}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::TimesheetReport",
        "method": "fetch_timesheet_entries"
      },
      "user_input": "@latest_timesheet_id",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "09a13637b163306486e0c6853f7ba457bf5ac12d2ccb894addd43ed17b9162cd",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/reports/company_report.rb",
      "line": 52,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scoper.find(:all, :joins => \"INNER JOIN flexifields on helpdesk_tickets.id = flexifields.flexifield_set_id and helpdesk_tickets.account_id = flexifields.account_id\", :select => (\"count(*) count, #{column_names}\"), :conditions => ([\"#{orderby_column} is NOT NULL and helpdesk_tickets.owner_id = ?\", params[:customer_id]]), :group => (\"#{column_names}\"), :order => (\"#{orderby_column}\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::CompanyReport",
        "method": "get_nested_data"
      },
      "user_input": "column_names",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "0b4d84cda47c9c6d472e74a78a8e204114daa3fe7282f6e9fe642f05472c306f",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_associated_ticket.html.erb",
      "line": 24,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.ticket_from\", :username => requester((Unresolved Model).new))",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "associated_tickets",
          "line": 1489,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_associated_ticket"
      },
      "user_input": "(Unresolved Model).new",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "0cf64eb79f482b361f7a0c73c43b26e7a11202c613fa05374c537c93372f4849",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/reports/company_report.rb",
      "line": 61,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Account.current.tickets.visible.find(:all, :select => (\"count(*) count,DATE(CONVERT_TZ(helpdesk_ticket_states.#{type},'+00:00','#{Time.zone.formatted_offset}')) date\"), :joins => \"INNER JOIN helpdesk_ticket_states on helpdesk_tickets.id = helpdesk_ticket_states.ticket_id and helpdesk_tickets.account_id = helpdesk_ticket_states.account_id\", :conditions => fetch_condition(type), :group => (\"DATE(CONVERT_TZ(helpdesk_ticket_states.#{type},'+00:00','#{Time.zone.formatted_offset}'))\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::CompanyReport",
        "method": "group_tkts_by_timeline"
      },
      "user_input": "type",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "0e6d417d6c1019f4f96743d804c1c11060abe27dc572383f6f6a06a504a521b6",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_note.html.erb",
      "line": 104,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"helpdesk.tickets.note.#{(\"last_deleted_info\" or \"last_edited_info\")}\", :user_name => link_to_user(@note_last_modified_user_hash[(Unresolved Model).new.id.to_s]), :note_date => formated_date((Unresolved Model).new.last_modified_timestamp), :timestamp => (Unresolved Model).new.last_modified_timestamp.to_i)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::ArchiveNotesController",
          "method": "index",
          "line": 20,
          "file": "app/controllers/helpdesk/archive_notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/show/_conversations.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_note"
      },
      "user_input": "(Unresolved Model).new.last_modified_timestamp",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "0ea467f5eb2518b4e7a74025c8d200c9c80366389e98a20ed3eacd31c83446f2",
      "message": "Unescaped model attribute",
      "file": "app/views/accounts/show.html.erb",
      "line": 14,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\".restore_account\", :delete_at => formated_date(14.days.since(DeletedCustomers.find_by_account_id(current_account.id).created_at), :format => :short_day_with_week, :include_year => true))",
      "render_path": [
        {
          "type": "controller",
          "class": "AccountsController",
          "method": "show",
          "line": 64,
          "file": "app/controllers/accounts_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "accounts/show"
      },
      "user_input": "DeletedCustomers.find_by_account_id(current_account.id).created_at",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "0f4f184aabc2bf2dad3727a32d5f73f7c5cc7fdd2c14086b18ec2889958df253",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/access.rb",
      "line": 138,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scope(:all_user_accessible, lambda do\n { :select => \"accessible_id, accessible_type, access_type, helpdesk_accesses.account_id\", :joins => (\"#{user_accesses_join(type, user)} #{group_accesses_join(type, user)} #{agent_groups_join}\"), :conditions => (\"#{type_conditions(type)} AND (#{user_conditions(user).values.join(\" OR \")})\") }\n end)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Access",
        "method": null
      },
      "user_input": "user_accesses_join(type, user)",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "0fbe202ebfaed8bdbc72d38a2123e5fa4b87cc96bbe0b3a78e37eb8febc6e92c",
      "message": "Unescaped parameter value",
      "file": "app/views/forum_shared/_topic_vote.html.erb",
      "line": 5,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\".#{scoper.find(params[:category_id]).forums.find(params[:forum_id]).type_symbol}.vote_info_include_#{(1 or 2)}\", :vote => (((1 or 2) == 2) ? ((topic_vote.user_votes - 1)) : (topic_vote.user_votes)))",
      "render_path": [
        {
          "type": "controller",
          "class": "TopicsController",
          "method": "show",
          "line": 50,
          "file": "app/controllers/topics_controller.rb"
        },
        {
          "type": "template",
          "name": "topics/show",
          "line": 148,
          "file": "app/views/topics/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "forum_shared/_topic_vote"
      },
      "user_input": "params[:category_id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "0fd1cd7c74378144693e5f962b44bbf06ca39d24321b1d5f13340f258bc492e4",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/dashboard/_ticket_note.html.erb",
      "line": 3,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "Liquid::Template.parse(h(t((Unresolved Model).new.description))).render(eval_activity_data((Unresolved Model).new.activity_data).merge(\"user_path\" => link_to_user((Unresolved Model).new.user), \"notable_path\" => (if (Unresolved Model).new.notable.nil? then\n  (Unresolved Model).new.activity_data[:title]\nelse\n  link_to(h((Unresolved Model).new.notable), find_activity_url((Unresolved Model).new), :class => \"notelink\")\nend)))",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::DashboardController",
          "method": "index",
          "line": 39,
          "file": "app/controllers/helpdesk/dashboard_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/dashboard/_ticket_note"
      },
      "user_input": "(Unresolved Model).new.activity_data",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "1057ae2b3fa0bcddb577744fc49452ab4e24f8890c654e493dd40017e4193b53",
      "message": "Render path contains parameter value",
      "file": "app/controllers/discussions/topics_controller.rb",
      "line": 153,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(partial => \"discussions/topics/components/#{params[:name]}\", {})",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Discussions::TopicsController",
        "method": "component"
      },
      "user_input": "params[:name]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "10b29e05dc0a9bd4a2214b5a528cf403d18f1d68dc2adc66c232af9cc032f79b",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/dashboard/data_layer.rb",
      "line": 67,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "default_scoper.where(filter_condition.except(\"helpdesk_schema_less_tickets.product_id\")).where(\"#{workload_name} is not NULL\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Dashboard::DataLayer",
        "method": "aggregation_from_db"
      },
      "user_input": "workload_name",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "110f1a66e48e94246324e615e67cc09850d6e4e0ae81b7fccb61b04867c1e2dd",
      "message": "Possible SQL injection",
      "file": "app/models/custom_survey/survey_result.rb",
      "line": 76,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scope(:agent_wise, lambda do\n { :select => (\"agent_id as id, survey_result_data.#{condition[:column_name]} as rating, \\n                    count(*) as total\"), :joins => \"INNER JOIN `survey_result_data` ON\\n                  `survey_result_data`.`survey_result_id` = `survey_results`.`id` AND\\n                    `survey_result_data`.`account_id` = `survey_results`.`account_id`\", :group => (\"survey_results.agent_id, survey_result_data.#{condition[:column_name]}\"), :order => (\"survey_result_data.#{condition[:column_name]}\"), :conditions => ([\"survey_results.survey_id = ? \\n                        and survey_results.created_at between ? and ?\", condition[:survey_id], condition[:start_date], condition[:end_date]]) }\n end)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "CustomSurvey::SurveyResult",
        "method": null
      },
      "user_input": "condition[:column_name]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "180e6cec020e4f55c312812d1e821a7e4b02d760ea9bf04a37b0c89208db7273",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/helpdesk/adjacent_archive_tickets.rb",
      "line": 42,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "current_account.archive_tickets.find(:first, :conditions => ([\"id #{{ :prev => ({ :sql_operator => \"<\", :order => \"DESC\", :list_push => \"left\", :which_end => \"last\", :list_index_operator => \"-\" }), :next => ({ :sql_operator => \">\", :order => \"ASC\", :list_push => \"right\", :which_end => \"first\", :list_index_operator => \"+\" }) }[direction][:sql_operator]} ?\", @item.id]), :order => (\"id #{{ :prev => ({ :sql_operator => \"<\", :order => \"DESC\", :list_push => \"left\", :which_end => \"last\", :list_index_operator => \"-\" }), :next => ({ :sql_operator => \">\", :order => \"ASC\", :list_push => \"right\", :which_end => \"first\", :list_index_operator => \"+\" }) }[direction][:order]}\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::AdjacentArchiveTickets",
        "method": "find_in_all"
      },
      "user_input": "{ :prev => ({ :sql_operator => \"<\", :order => \"DESC\", :list_push => \"left\", :which_end => \"last\", :list_index_operator => \"-\" }), :next => ({ :sql_operator => \">\", :order => \"ASC\", :list_push => \"right\", :which_end => \"first\", :list_index_operator => \"+\" }) }[direction][:sql_operator]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "18f02756a041729907d3ce1b645dea4b7877318326de3b3b65f922a1e2506664",
      "message": "Render path contains parameter value",
      "file": "app/controllers/integrations/service_proxy_controller.rb",
      "line": 12,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => { IntegrationServices::Service.get_service_class(params[:app_name]).new(current_account.installed_applications.with_name(params[:app_name]).first, (if params[:payload].present? then\n  JSON.parse(params[:payload], :symbolize_names => true)\nelse\n  nil\nend)).web_meta.delete(:content_type) => IntegrationServices::Service.get_service_class(params[:app_name]).new(current_account.installed_applications.with_name(params[:app_name]).first, (if params[:payload].present? then\n  JSON.parse(params[:payload], :symbolize_names => true)\nelse\n  nil\nend)).receive(params[:event]) }, {})",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Integrations::ServiceProxyController",
        "method": "fetch"
      },
      "user_input": "params[:event]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "1ae8fff5503f6dbfecf07b3d7e9a5ed9d8eaa8e42b7b9591913a7f65691c1240",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/spam/core/base.rb",
      "line": 78,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::Ticket.new(model.associations_data[:helpdesk_tickets]).notes.build(note.associations_data[:helpdesk_notes])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Spam::Core::Base",
        "method": "restore_tickets_and_notes"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "1da7f7914be980667147e5c9304877d014d00c12f526f0b710c834bc3e3597dc",
      "message": "Possible SQL injection",
      "file": "app/controllers/supreme/sql_console_controller.rb",
      "line": 11,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "ActiveRecord::Base.connection.execute(params[:query])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Supreme::SqlConsoleController",
        "method": "execute_query"
      },
      "user_input": "params[:query]",
      "confidence": "High",
      "note": "This is required for supreme console. Access is restricted via ip checks."
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "1eacb00d793904d4eb92dabcbebdcb6346c77775caf9576c0605f1a67610f489",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_activity.html.erb",
      "line": 43,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new[:stack].size",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "activities",
          "line": 1342,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/activities",
          "line": 3,
          "file": "app/views/helpdesk/tickets/activities.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_activity"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "1edc78e9fbb2eaa81eb8d0a4a87364d1f0fee3adc100b18315271db3d37d0fd7",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/notes/public_conversation.html.erb",
      "line": 2,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Helpdesk::Ticket.find_by_param(params[:ticket_id], current_account) or Helpdesk::Issue.find_by_id(params[:issue_id])).description_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "public_conversation",
          "line": 135,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/notes/public_conversation"
      },
      "user_input": "params[:ticket_id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "1f93988ed7db56135784cf0df1c29b871fdd901dc092323c0bf27078c64472b6",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket_state.rb",
      "line": 166,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "tickets.notes.visible.agent_public_responses.first(:select => (\"count(*) as outbounds, \\n        round(avg(helpdesk_schema_less_notes.#{Helpdesk::SchemaLessNote.resp_time_column}), 3) as avg_resp_time, \\n        round(avg(helpdesk_schema_less_notes.#{Helpdesk::SchemaLessNote.resp_time_by_bhrs_column}), 3) as avg_resp_time_bhrs\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::TicketState",
        "method": "set_avg_response_time"
      },
      "user_input": "Helpdesk::SchemaLessNote.resp_time_column",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "22bcaba9f7ee482502e09b87d1972afbb344e4b74273767520eefa1d12e23dc1",
      "message": "Unescaped parameter value",
      "file": "app/views/topics/show.html.erb",
      "line": 138,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(scoper.find(params[:category_id]).forums.find(params[:forum_id]).topics.find(params[:id]) or (current_account.portal_topics.find(params[:id]) or nil)).posts.first.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "TopicsController",
          "method": "show",
          "line": 50,
          "file": "app/controllers/topics_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "topics/show"
      },
      "user_input": "params[:category_id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "22eda6de87894a84559ee6525e78b41c0f5df5fec013bea4c1a82dcbdb21a9cc",
      "message": "Unescaped parameter value",
      "file": "app/views/admin/email_notifications/_helpnote.html.erb",
      "line": 1,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"email_notifications.helpcard.#{params[:type]}_#{scoper.find_by_id(params[:id]).notification_type.to_s}.topic\")",
      "render_path": [
        {
          "type": "controller",
          "class": "Admin::EmailNotificationsController",
          "method": "edit",
          "line": 55,
          "file": "app/controllers/admin/email_notifications_controller.rb"
        },
        {
          "type": "template",
          "name": "admin/email_notifications/edit",
          "line": 518,
          "file": "app/views/admin/email_notifications/edit.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "admin/email_notifications/_helpnote"
      },
      "user_input": "params[:type]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "23ddbea531b55d9a5fc18305d6909b417b5bed091e8be2a5b67f9397ff83fcde",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/archive_note/s3.rb",
      "line": 7,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::ArchiveNoteAssociation.new(Helpdesk::S3::ArchiveNote::Body.get_from_s3(self.account_id, self.id)[\"archive_note_association\"])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ArchiveNote",
        "method": "read_from_s3"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "2591b5b87e89bbcc40f2473a76977f3309b328ca440f118626d7e38c5aa8e7b7",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_associated_ticket.html.erb",
      "line": 22,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.ticket_to\", :username => requester((Unresolved Model).new))",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "associated_tickets",
          "line": 1489,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_associated_ticket"
      },
      "user_input": "(Unresolved Model).new",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "25d4c9f49aa5ee0735e82bd29933e6df78edf27a6319fab97e97e084d3bba764",
      "message": "Unprotected mass assignment",
      "file": "lib/admin/advanced_ticketing/field_service_management/util.rb",
      "line": 114,
      "link": "http://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "FlexifieldDefEntry.new(ff_meta_data(field_details, account, :alias_present => true, :signup_flow => (@fsm_signup_flow)))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Admin::AdvancedTicketing::FieldServiceManagement::Util",
        "method": "create_fsm_field"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "2656ef2a6b750b05b5711126d8c20ca1cc4acaa5f54781543fd24318e3c9197b",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/dashboard/data_layer.rb",
      "line": 72,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "default_scoper.where(filter_condition).where(\"#{workload_name} is not NULL\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Dashboard::DataLayer",
        "method": "aggregation_from_db"
      },
      "user_input": "workload_name",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "268ba2ab1d32e2c5f45a7656042050bb2ea9656e06eb40984a86c9169cfbec95",
      "message": "Render path contains parameter value",
      "file": "app/controllers/freshcaller_proxy_controller.rb",
      "line": 15,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => fetch_response(params), {})",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "FreshcallerProxyController",
        "method": "fetch"
      },
      "user_input": "params",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "2805db54a76837c64c83472814ea6f8b1440588c539fd45ab90393f0d379a325",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/partner_admin/affiliates_controller.rb",
      "line": 51,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "SubscriptionAffiliate.new(ActiveSupport::JSON.decode(request.body.read))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PartnerAdmin::AffiliatesController",
        "method": "add_reseller"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "2945d7f78134f1224c1d2d0191094533b1e90e0be22e6728dfe9e457711738b3",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/controllers/helpdesk/dashboard_controller.rb",
      "line": 202,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "current_account.agents.where(:user_id => (@group.round_robin_queue.reverse + (@group.agents.all(:select => \"users.id\").map(&:id).map(&:to_s) - @group.round_robin_queue.reverse))).includes([{ :user => :avatar }]).reorder(\"field(user_id, #{(@group.round_robin_queue.reverse + (@group.agents.all(:select => \"users.id\").map(&:id).map(&:to_s) - @group.round_robin_queue.reverse)).join(\",\")})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::DashboardController",
        "method": "load_ticket_assignment"
      },
      "user_input": "(@group.round_robin_queue.reverse + (@group.agents.all(:select => \"users.id\").map(&:id).map(&:to_s) - @group.round_robin_queue.reverse)).join(\",\")",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "2cae4b3de20bb6b65fc23516e8e60be26fc31d7f9617bf77e7b1157f33109bc3",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/tickets/show/_ticket_association.html.erb",
      "line": 138,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t((\"ticket.ticket_user_list_status_\" + load_by_param(params[:id]).ticket_states.current_state(load_by_param(params[:id]).outbound_email?)), :time_ago => time_ago_in_words(load_by_param(params[:id]).ticket_states.safe_send(load_by_param(params[:id]).ticket_states.current_state(load_by_param(params[:id]).outbound_email?))))",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "ticket_association",
          "line": 1054,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_ticket_association"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "2d10d5659490097d2534094acdef547a3949bd77316f3178882772723dfff8d1",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/integrations/integrated_resource.rb",
      "line": 18,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "self.new(params[:integrated_resource].dup)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Integrations::IntegratedResource",
        "method": "Integrations::IntegratedResource.createResource"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "2db7029b4ac3121d9dc9ab743b27e79fd49e7f4f38f271911d734eecffc52e06",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket.rb",
      "line": 112,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "self.where(\"helpdesk_tickets.requester_id = ? #{operator} helpdesk_tickets.owner_id in (?)\", user_id, company_ids)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticket",
        "method": null
      },
      "user_input": "operator",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "2e2fe7127e5353706a9ebf9ec30c90eadc769c1c72d35189a6a27961b7ffece8",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/filter_factory/filter/es_cluster_helper_methods.rb",
      "line": 86,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scoper[:ar_class].constantize.joins(fetch_joins).where(:account_id => Account.current.id, :id => object_ids).order(\"#{order_by} #{order_type.upcase}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "FilterFactory::Filter::EsClusterHelperMethods",
        "method": "fetch_ar_records"
      },
      "user_input": "order_by",
      "confidence": "Weak",
      "note": "Order by vaues are validated in controller . This can be ignored."
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "316a64626aa6dfcc2ceebd848962dd9cd81a2df96aa115bb71e5cff4267911b7",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_note.html.erb",
      "line": 136,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"helpdesk.tickets.note.created_on_live.#{((Unresolved Model).new.kind or \"survey\")}\", :user_name => link_to_user((Unresolved Model).new.user), :note_date => formated_date((Unresolved Model).new.created_at), :timestamp => (Unresolved Model).new.created_at.to_i)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "index",
          "line": 39,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/tickets/show/_conversations.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_note"
      },
      "user_input": "(Unresolved Model).new.kind",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "328b25585a61fc8a51250a8206e29fb0a084741a95b52f7cdd50b19f9a3f215a",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "lib/helpdesk/initializers/githooks.rb",
      "line": 7,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`ln -s \"#{Rails.root}/script/githooks/#{script_name}\" \"#{Rails.root}/.git/hooks/#{script_name}\"`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GitHooksInit",
        "method": "s(:self).link_script"
      },
      "user_input": "script_name",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "33cd97663c4f31bee5f237800e3c278df3a3b0ae95e9248fcb5bfb5b0b1e2975",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/integrations/github_controller.rb",
      "line": 107,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to(Integrations::Application.find_by_name(APP_NAME).oauth_url(:account_id => @current_account.id, :portal_id => current_portal.id))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Integrations::GithubController",
        "method": "oauth_install"
      },
      "user_input": "Integrations::Application.find_by_name(APP_NAME).oauth_url(:account_id => @current_account.id, :portal_id => current_portal.id)",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "34d59b63c6182ee1057303866a005cf2a40ebb0a6410c18eef27a9d3e6bd6deb",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket_state.rb",
      "line": 200,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"INSERT INTO #{stats_table} (#{\"account_id,ticket_id,created_at,created_hour,resolved_hour,received_tickets,resolved_tickets,num_of_reopens,assigned_tickets,num_of_reassigns,fcr_tickets,sla_tickets\"}) VALUES(#{account_id},#{ticket_id},\\n            '#{created_at.strftime(\"%Y-%m-%d 00:00:00\")}','#{created_at.hour}',\\n            #{(\"\\\\N\" or created_at.hour)},1,#{(0 or 1)},0,#{(1 or 0)},0,#{(0 or 1)},#{(0 or 1)})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::TicketState",
        "method": "create_ticket_stats"
      },
      "user_input": "stats_table",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "37792c6b8a7594dbf1d7015d8a9a07cd4c1243d8b54c9db07a24e97212f4320b",
      "message": "Possible SQL injection",
      "file": "lib/sync/sql_util.rb",
      "line": 35,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "ActiveRecord::Base.connection.execute(\"DELETE from #{table_name} where #{habtm_condition(arel_values)}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sync::SqlUtil",
        "method": "delete_habtm_record"
      },
      "user_input": "table_name",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "3a7237847de585f7e7714fee0ce20618574e910509c78aa26b9ab11eb043fe96",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket_state.rb",
      "line": 230,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"SELECT * FROM #{stats_table} where ticket_id = #{ticket_id} and \\n        account_id = #{account_id} and created_at = '#{updated_at.strftime(\"%Y-%m-%d 00:00:00\")}' \")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::TicketState",
        "method": "update_ticket_stats"
      },
      "user_input": "stats_table",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "3a96ddee92aa3802ac279aa80b0c3900c32a8f8383ebbe72e793cc21f30a3664",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/helpdesk/ticketfields/controller_methods.rb",
      "line": 5,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "FlexifieldDefEntry.new(ff_meta_data(field_details, account))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticketfields::ControllerMethods",
        "method": "create_field"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "3e4f1e12b429ba8fd7a716bca93942981bdcb9a12b2aee4f82946a54d053ac37",
      "message": "Unescaped parameter value",
      "file": "app/views/social/twitter_handles/_signin_info.html.erb",
      "line": 11,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\".associate_account\", :product_name => (if current_account.products.find(params[:product_id]) then\n  current_account.products.find(params[:product_id]).name\nelse\n  current_account.portal_name\nend))",
      "render_path": [
        {
          "type": "controller",
          "class": "Social::TwitterHandlesController",
          "method": "signin",
          "line": 77,
          "file": "app/controllers/social/twitter_handles_controller.rb"
        },
        {
          "type": "template",
          "name": "social/twitter_handles/signin",
          "line": 1,
          "file": "app/views/social/twitter_handles/signin.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "social/twitter_handles/_signin_info"
      },
      "user_input": "params[:product_id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "3ed10f2a002aac254dc2db1401e34363668985487b79d319574e1d76dde4b4ef",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/collab_tickets/show/_note.html.erb",
      "line": 94,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"helpdesk.tickets.note.#{(\"last_deleted_info\" or \"last_edited_info\")}\", :user_name => link_to_user(@note_last_modified_user_hash[(Unresolved Model).new.id.to_s]), :note_date => formated_date((Unresolved Model).new.last_modified_timestamp), :timestamp => (Unresolved Model).new.last_modified_timestamp.to_i)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::CollabTicketsController",
          "method": "show",
          "line": 17,
          "file": "app/controllers/helpdesk/collab_tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show",
          "line": 52,
          "file": "app/views/helpdesk/collab_tickets/show.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/collab_tickets/show/_conversations.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/collab_tickets/show/_note"
      },
      "user_input": "(Unresolved Model).new.last_modified_timestamp",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "40bf886acea7395a612afd9d1bea9a185b9d9724cdb67f59de199518c548fc82",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/collab_tickets/show/_ticket_field_elements.html.erb",
      "line": 49,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(\"\" << construct_ticket_element(f, :helpdesk_ticket, field, (t(\"ticket_fields.fields.#{field.name}\") or field.label.html_safe), (\"dropdown\" or field.dom_type), field.required, ((current_account.tickets.find_by_display_id(params[:id]).safe_send(field.field_name) or fetch_custom_field_value(current_account.tickets.find_by_display_id(params[:id]), field.name)) or { (ff[:level] == 2) ? (:subcategory_val) : (:item_val) => fetch_custom_field_value(current_account.tickets.find_by_display_id(params[:id]), ff[:name]), :category_val => fetch_custom_field_value(current_account.tickets.find_by_display_id(params[:id]), field.name) }), \"\", false, false).html_safe)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::CollabTicketsController",
          "method": "show",
          "line": 17,
          "file": "app/controllers/helpdesk/collab_tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show",
          "line": 32,
          "file": "app/views/helpdesk/collab_tickets/show.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show/_sidebar",
          "line": 8,
          "file": "app/views/helpdesk/collab_tickets/show/_sidebar.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show/_ticket_fields",
          "line": 9,
          "file": "app/views/helpdesk/collab_tickets/show/_ticket_fields.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/collab_tickets/show/_ticket_field_elements"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "40cdb0d1f98a46ec59eade8ad71fdd4d107cce0030c2ba1145da23df74295b3d",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "lib/helpdesk/initializers/githooks.rb",
      "line": 8,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`chmod +x \"#{Rails.root}/.git/hooks/#{script_name}\"`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GitHooksInit",
        "method": "s(:self).link_script"
      },
      "user_input": "script_name",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "411273530fe888c1923d6af5bc345ef655f378ade17483407543a593fb3a3e40",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped parameter value",
      "file": "app/views/integrations/hootsuite/tickets/_ticket_field_elements.html.erb",
      "line": 28,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(\"\" << construct_new_ticket_element(f, :helpdesk_ticket, field, t(\"ticket_fields.fields.#{field.name}\"), (\"dropdown\" or field.dom_type), field.required, (scoper.find_by_display_id(params[:id]).safe_send(field.field_name) or nested_ticket_field_value(scoper.find_by_display_id(params[:id]), field)), \"\", false, false).html_safe)",
      "render_path": [
        {
          "type": "controller",
          "class": "Integrations::Hootsuite::TicketsController",
          "method": "show",
          "line": 21,
          "file": "app/controllers/integrations/hootsuite/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "integrations/hootsuite/tickets/show",
          "line": 110,
          "file": "app/views/integrations/hootsuite/tickets/show.html.erb"
        },
        {
          "type": "template",
          "name": "integrations/hootsuite/tickets/_ticket_fields",
          "line": 18,
          "file": "app/views/integrations/hootsuite/tickets/_ticket_fields.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "integrations/hootsuite/tickets/_ticket_field_elements"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "412a1d92c04a2fb7afa53c8011f1c05754b508ad1ac527c4c514943fcf2aaaa2",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/contacts_controller.rb",
      "line": 326,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to(scoper.find(params[:id]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ContactsController",
        "method": "make_agent"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "429e8524eb7b448c8b44ead7bf448701cb076dd6f4c6b314061f4f59556b1348",
      "message": "Unsafe reflection method constantize called with parameter value",
      "file": "app/controllers/discussions/unpublished_controller.rb",
      "line": 78,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "params[:scope].constantize",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Discussions::UnpublishedController",
        "method": "spam_scope"
      },
      "user_input": "params[:scope]",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "42ebbda81c846125665c3f7df12c9511f7cd17667a49f7a68ba9f2981d07ffae",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/helpdesk/email/incoming_email_handler.rb",
      "line": 573,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::Ticket.new(build_ticket_params(account, get_user(account, ({} or orig_email_from_text), email_config, true), to_email, parse_all_cc_emails(account.kbase_email, account.support_emails)[(0..48)], email_config))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Email::IncomingEmailHandler",
        "method": "create_ticket"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "43b8fb4ff84f36530288bf0cea14457b81386b6894bda70e828852ba797ea270",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/wf/filter.rb",
      "line": 500,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "self.name.constantize.new(params[:wf_model])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Wf::Filter",
        "method": "Wf::Filter.deserialize_from_params"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "43bf0513205ebd9ec136a0638a2a600649f4130fe4ab47d6433a25f03a331ee4",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/subscription_affiliate.rb",
      "line": 184,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "subscription_payments.all(:conditions => ([\"created_at > '#{1.year.ago}'\"]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "SubscriptionAffiliate",
        "method": "fees"
      },
      "user_input": "1.year.ago",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "45a4253d99c7ff59f398edc154e9955ec6aaa0d3a05098493e4b731c6906a30f",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_custom_survey_note.html.erb",
      "line": 42,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::ArchiveNotesController",
          "method": "index",
          "line": 20,
          "file": "app/controllers/helpdesk/archive_notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/show/_conversations.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/show/_note",
          "line": 110,
          "file": "app/views/helpdesk/archive_tickets/show/_note.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_custom_survey_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "45a4253d99c7ff59f398edc154e9955ec6aaa0d3a05098493e4b731c6906a30f",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_custom_survey_note.html.erb",
      "line": 38,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::ArchiveNotesController",
          "method": "index",
          "line": 20,
          "file": "app/controllers/helpdesk/archive_notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/show/_conversations.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/show/_note",
          "line": 110,
          "file": "app/views/helpdesk/archive_tickets/show/_note.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_custom_survey_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "475d03d952d51d0baa5fba0a5a6e9f69f3a910e1e8be32d3197ed93bcab540e8",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/reports/timesheet_report.rb",
      "line": 181,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scoper(@start_date, @end_date).where(\"helpdesk_time_sheets.id <= #{@latest_timesheet_id}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::TimesheetReport",
        "method": "fetch_timesheet_entries"
      },
      "user_input": "@latest_timesheet_id",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "48fe5c26d0aaf55e2671e6c975da40fab30b4140e2c7a21569e4cbbe21b3b457",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/support/discussions/topics_controller.rb",
      "line": 102,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "SQSPost.new(sqs_post_param)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Support::Discussions::TopicsController",
        "method": "sqs_create"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": "It is a validated set of params. Warning is because of the word param in the name."
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "49a036f9f43ca810cd94d83ed01cf23d2fc153c8b20e7c4aee47ec9b7fa64e3c",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/note/attributes.rb",
      "line": 31,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::NoteBody.new(options)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Note",
        "method": "note_body_attributes="
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "4b94d3aa16d0182b2add944df6169907881255fc2295db5837d58b6ff5d2d9a9",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/tickets/show/_sticky_status.html.erb",
      "line": 6,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t((if (load_by_param(params[:id], preload_options).due_by > Time.now) then\n  \"ticket_future_due_by_live\"\nelse\n  \"ticket_past_due_by_live\"\nend), :time => distance_of_time_in_words(Time.now, load_by_param(params[:id], preload_options).due_by), :timestamp => load_by_param(params[:id], preload_options).due_by.to_i)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "change_due_by",
          "line": 1063,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_due_by",
          "line": 20,
          "file": "app/views/helpdesk/tickets/show/_due_by.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_sticky_status"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "4d4ab29d03602c7686aeaba8049380ecb40a4555c73853763f680db21ecb101e",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_related_ticket.html.erb",
      "line": 18,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.ticket_from\", :username => requester((Unresolved Model).new))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_related_tickets_container",
          "line": 3,
          "file": "app/views/helpdesk/tickets/show/_related_tickets_container.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_related_ticket"
      },
      "user_input": "(Unresolved Model).new",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "4e8308d0e03ce30eba740351836f8a08aa42deba89a7ad5086197873195dbe55",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/account_configuration.rb",
      "line": 73,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "self.update_attributes!(user_params.slice(*([:full_name, :first_name, :last_name, :email, :notification_emails, :job_title, :phone] + [:name, :industry].map do\n \"company_#{:BRAKEMAN_SAFE_LITERAL}\"\n end)))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "AccountConfiguration",
        "method": "update_contact_company_info!"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "4efc859b74951f9c1460c67235dfd8fe59c8c1f04352f11a7ad3b99f3d640203",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_related_ticket.html.erb",
      "line": 22,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t((\"ticket.ticket_user_list_status_\" + (Unresolved Model).new.ticket_states.current_state((Unresolved Model).new.outbound_email?)), :time_ago => time_ago_in_words((Unresolved Model).new.ticket_states.safe_send((Unresolved Model).new.ticket_states.current_state((Unresolved Model).new.outbound_email?))))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_related_tickets_container",
          "line": 3,
          "file": "app/views/helpdesk/tickets/show/_related_tickets_container.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_related_ticket"
      },
      "user_input": "(Unresolved Model).new.ticket_states",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "4f30b680d99a4e9b82473fa4836d8c5e9114963da039296242a88c69fe5cd1f4",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket_state.rb",
      "line": 301,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"UPDATE #{stats_table_name} SET #{\"#{\"resolved_tickets = #{1}, resolved_hour = #{resolved_at.hour}, \\n        fcr_tickets = #{(1 or 0)}, sla_tickets = #{(1 or 0)}\"},#{\"assigned_tickets = #{1}\"},#{\"num_of_reassigns = #{((field_hash[:num_of_reassigns].to_i + 1) or 1)}\"},#{\"num_of_reopens = #{((field_hash[:num_of_reopens].to_i + 1) or 1)},#{\"resolved_tickets = 0,resolved_hour = \\\\N,fcr_tickets = 0,sla_tickets = 0\"}\"}\"} where ticket_id = #{ticket_id} and \\n        account_id = #{account_id} and created_at = '#{datetime}'\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::TicketState",
        "method": "check_and_update_ticket_stats"
      },
      "user_input": "stats_table_name",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "4f5783711f2b7c03060ddb4a120387ca90e2af150743df1e85c9dd2542301ed7",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/archive_ticket.rb",
      "line": 358,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::TicketState.new(archive_ticket_state)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ArchiveTicket",
        "method": "ticket_states"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": "Controlled parameter set generated via code. Not an issue."
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "5043e31aa7148c47269112bae813091b000c75592a0ca091b160098dce014c77",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/spam/core/base.rb",
      "line": 57,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::Ticket.new(model.associations_data[:helpdesk_tickets])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Spam::Core::Base",
        "method": "restore_tickets_and_notes"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "511c1b1389814d2fc0cb726b6b89d1e9c84ceaff331f2aa5041d48e65c024258",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/shared/expanded/_ticket.html.erb",
      "line": 60,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.ticket_to\", :username => requester((Unresolved Model).new))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tags/show",
          "line": 67,
          "file": "app/views/helpdesk/tags/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/shared/expanded/_ticket"
      },
      "user_input": "(Unresolved Model).new",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "51ed18f54e087a64d8240a2a4b89b577e675e2c06a3a7e9d75eb4f571be09cdd",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_note.html.erb",
      "line": 77,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"helpdesk.tickets.note.created_on_live.#{((Unresolved Model).new.kind or \"survey\")}\", :user_name => link_to_user((Unresolved Model).new.user), :note_date => formated_date((Unresolved Model).new.created_at), :timestamp => (Unresolved Model).new.created_at.to_i)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::ArchiveNotesController",
          "method": "index",
          "line": 20,
          "file": "app/controllers/helpdesk/archive_notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/show/_conversations.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_note"
      },
      "user_input": "(Unresolved Model).new.kind",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "52e999898676de5c659ecd85c35e6d52c667f109a2c115a03b0bf6b8ed2bc601",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_associated_ticket.html.erb",
      "line": 28,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t((\"ticket.ticket_user_list_status_\" + (Unresolved Model).new.ticket_states.current_state((Unresolved Model).new.outbound_email?)), :time_ago => time_ago_in_words((Unresolved Model).new.ticket_states.safe_send((Unresolved Model).new.ticket_states.current_state((Unresolved Model).new.outbound_email?))))",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "associated_tickets",
          "line": 1489,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_associated_ticket"
      },
      "user_input": "(Unresolved Model).new.ticket_states",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "5322e94c7c808f61b069005128ea394c03b3e11909926896092bc4e15236b861",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/note/s3.rb",
      "line": 11,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::NoteBody.new(Helpdesk::S3::Note::Body.get_from_s3(self.account_id, self.id))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Note",
        "method": "read_from_s3"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "547d07af761430140fb6c8d9ca65aeaa82f69971a6a7848f8580610208fd19d3",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/spam/core/base.rb",
      "line": 63,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::Ticket.new(model.associations_data[:helpdesk_tickets]).safe_send(key).build(value)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Spam::Core::Base",
        "method": "restore_tickets_and_notes"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "563e1e93ff14168ad0d09df2342836699bd894347d531b1ea0b07183f7b437a7",
      "message": "Possible command injection",
      "file": "lib/import_csv_util.rb",
      "line": 35,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "Open3.capture2(\"wc\", \"-l\", params[:file].path)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ImportCsvUtil",
        "method": "store_file"
      },
      "user_input": "params[:file].path",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "563f6e1443d7e04aaabaa914c2ee068a5be639928fbafa96024fc00240c5af76",
      "message": "Render path contains parameter value",
      "file": "app/controllers/helpdesk/archive_tickets_controller.rb",
      "line": 160,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(partial => \"helpdesk/tickets/show/#{params[:component]}\", { :locals => ({ :ticket => current_account.archive_tickets.find_by_id(params[:id]), :search_query => params[:q] }) })",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ArchiveTicketsController",
        "method": "component"
      },
      "user_input": "params[:component]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "567c24e92b811ca869eb8c646ad21cf0ad222d85299960ac9269bb6b5fa27369",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/_note.html.erb",
      "line": 46,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\".posted_on\", :user_name => link_to_user((Unresolved Model).new.user), :note_date => formated_date((Unresolved Model).new.created_at))",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "index",
          "line": 41,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/_note"
      },
      "user_input": "(Unresolved Model).new.created_at",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "594c868414cefff75e128e069333806c04d8bfb18927bb8f32a303741d058db3",
      "message": "Possible SQL injection",
      "file": "app/models/group.rb",
      "line": 88,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scope(:skill_based_round_robin_enabled, :order => :name, :conditions => ([\"ticket_assign_type = #{Group::TICKET_ASSIGN_TYPE[:skill_based]}\"]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Group",
        "method": null
      },
      "user_input": "Group::TICKET_ASSIGN_TYPE[:skill_based]",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "59934e4e45362f887e3d75753d7697605d8db133fd4f9f56c413b647d7472b2d",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/reports/helpdesk_report.rb",
      "line": 42,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Account.current.tickets.visible.find(:all, :select => (\"count(*) count,DATE(CONVERT_TZ(helpdesk_ticket_states.#{type},'+00:00','#{Time.zone.formatted_offset}')) date\"), :joins => \"INNER JOIN helpdesk_ticket_states on helpdesk_tickets.id = helpdesk_ticket_states.ticket_id and helpdesk_tickets.account_id = helpdesk_ticket_states.account_id\", :conditions => fetch_condition(type), :group => (\"DATE(CONVERT_TZ(helpdesk_ticket_states.#{type},'+00:00','#{Time.zone.formatted_offset}'))\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::HelpdeskReport",
        "method": "group_tkts_by_timeline"
      },
      "user_input": "type",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "5b3ca8d41afe33ed67005b2f34be8996757bcd43bb73706a487c5d4dc95d711a",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/access.rb",
      "line": 145,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scope(:user_accessible_items_via_group, lambda do\n { :joins => (\"#{group_accesses_join(type, user)} #{agent_groups_join}\"), :conditions => (\"#{type_conditions(type)} AND (#{user_conditions(user)[:global]} OR #{user_conditions(user)[:users_via_group]})\"), :select => \"accessible_id, accessible_type, access_type\" }\n end)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Access",
        "method": null
      },
      "user_input": "group_accesses_join(type, user)",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "5b4003113381a4b03f0b08af93c22d9276183dee6e849a4483e2f4abcdcc4bfa",
      "message": "Possible SQL injection",
      "file": "app/models/custom_survey/survey_result.rb",
      "line": 63,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scope(:group_wise, lambda do\n { :select => (\"group_id as id, survey_result_data.#{condition[:column_name]} as rating,\\n                    count(*) as total\"), :joins => \"INNER JOIN `survey_result_data` ON\\n                  `survey_result_data`.`survey_result_id` = `survey_results`.`id` AND\\n                    `survey_result_data`.`account_id` = `survey_results`.`account_id`\", :group => (\"survey_results.group_id, survey_result_data.#{condition[:column_name]}\"), :order => (\"survey_result_data.#{condition[:column_name]}\"), :conditions => ([\"survey_results.survey_id = ? \\n                          and survey_results.created_at between ? and ?\", condition[:survey_id], condition[:start_date], condition[:end_date]]) }\n end)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "CustomSurvey::SurveyResult",
        "method": null
      },
      "user_input": "condition[:column_name]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "5c1fa3035a9be8412e94e6de1503b53c1403c5462ba129b6a963317870fb3b3d",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_activity.html.erb",
      "line": 15,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t((\"activities.tag.\" + (Unresolved Model).new[:important][:type]), :value => (Unresolved Model).new[:important][:value])",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "activities",
          "line": 1342,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/activities",
          "line": 3,
          "file": "app/views/helpdesk/tickets/activities.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_activity"
      },
      "user_input": "(Unresolved Model).new[:important]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "5e9e76ce4c097699faaba0982c296133800a8cf2b006d93cc91adcda3c8a4927",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/posts_controller.rb",
      "line": 64,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Topic.find_by_id_and_forum_id_and_account_id(params[:topic_id], params[:forum_id], current_account.id).posts.build(params[:post])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PostsController",
        "method": "create"
      },
      "user_input": "params[:post]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "5f0d4beeed1a142ead619cf2f703fd1e444693347d1a22fd864598440a8496c0",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/fdadmin/freshops_pod_controller.rb",
      "line": 76,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Ecommerce::EbayRemoteUser.new(validate_integration_params(params[:ebay_remote_user]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Fdadmin::FreshopsPodController",
        "method": "create_global_ebay_integration"
      },
      "user_input": "params[:ebay_remote_user]",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "6197ffafe33c3aa28a3dc400fbe13fd7755bf7bcee92e6d1e63d70da4fdf943c",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/archive_ticket.rb",
      "line": 362,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::TicketState.new(archive_ticket_association.association_data[\"helpdesk_tickets_association\"][\"ticket_states\"])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ArchiveTicket",
        "method": "ticket_states"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "61eb02b13acc36b8b60dc7d97101e7e2b7f0345a8deabf503257a749e9d44415",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/shared/expanded/_ticket.html.erb",
      "line": 86,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "((\"<span class='#{(subject_style((Unresolved Model).new, @onhold_and_closed_statuses) or \"\")} subject_style tooltip' data-original-title = '#{(t(\"helpdesk.tickets.friendly_status.overdue\") or \"\")}' data-placement = 'left'><span class= '#{(\"customer_responded_overdue_hover\" or \"\")}' ></span>\" + t(\"helpdesk.tickets.friendly_status.#{(subject_style((Unresolved Model).new, @onhold_and_closed_statuses) or \"\")}\")) + \"</span>\")",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tags/show",
          "line": 72,
          "file": "app/views/helpdesk/tags/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/shared/expanded/_ticket"
      },
      "user_input": "(Unresolved Model).new",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "62192e2d80e5cc005eb74e9cf786bbc3d3724e949362b4ab61022810b6c212e0",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_related_ticket.html.erb",
      "line": 16,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.ticket_to\", :username => requester((Unresolved Model).new))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_related_tickets_container",
          "line": 3,
          "file": "app/views/helpdesk/tickets/show/_related_tickets_container.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_related_ticket"
      },
      "user_input": "(Unresolved Model).new",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "6401cf99dd86bc7b24e659aca59fe070ad033ce4dfabba69057d7b2ad0c09f7c",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "app/controllers/omniauth_callbacks_controller.rb",
      "line": 27,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => Auth::Authenticator.get_auth_class(params[:provider]).new(:origin_account => origin_account, :current_account => current_account, :portal_url => (@ignore_build.blank? ? (portal_url) : (nil)), :app => app, :omniauth => (@omniauth), :user_id => (@user_id), :falcon_enabled => (@falcon_enabled), :state_params => (@state_params)).after_authenticate(params).render, {})",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "OmniauthCallbacksController",
        "method": "complete"
      },
      "user_input": "params",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "648451fa051f64ecba1b4de3fc8d24c2af8d6c7d782a999d174d50a1aaf9631e",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket.rb",
      "line": 332,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "from(\"#{\"helpdesk_tickets\"} USE INDEX(#{index})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticket",
        "method": "use_index"
      },
      "user_input": "index",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "65ce8f5cbc053812590a5aef834fa2c0659b54c8362693cc2e6d99562982d6cd",
      "message": "Unescaped parameter value",
      "file": "app/views/forum_shared/_topic_vote.html.erb",
      "line": 10,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\".#{scoper.find(params[:category_id]).forums.find(params[:forum_id]).type_symbol}.vote_info_#{(1 or 2)}\", :vote => topic_vote.user_votes)",
      "render_path": [
        {
          "type": "controller",
          "class": "TopicsController",
          "method": "show",
          "line": 50,
          "file": "app/controllers/topics_controller.rb"
        },
        {
          "type": "template",
          "name": "topics/show",
          "line": 148,
          "file": "app/views/topics/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "forum_shared/_topic_vote"
      },
      "user_input": "params[:category_id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "660d568daa2b43f56c2dce369a4b59cc8576c0b75ac502d2d96ec376cd12d1f2",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/reports/company_report.rb",
      "line": 42,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scoper.find(:all, :joins => \"INNER JOIN flexifields on helpdesk_tickets.id = flexifields.flexifield_set_id and helpdesk_tickets.account_id = flexifields.account_id\", :select => (\"count(*) count, #{vals[:column_name]}\"), :conditions => ([\" helpdesk_tickets.owner_id = ? and #{vals[:column_name]} is NOT NULL\", params[:customer_id]]), :group => (\"#{vals[:column_name]}\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::CompanyReport",
        "method": "group_tkts_by_columns"
      },
      "user_input": "vals[:column_name]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross-Site Request Forgery",
      "warning_code": 7,
      "fingerprint": "6839d23eb02cc5f66d6b2d1cf4750dbc3733691a1b7f2996016417cff9f71b45",
      "check_name": "ForgerySetting",
      "message": "'protect_from_forgery' should be called in DomainSearchController",
      "file": "app/controllers/domain_search_controller.rb",
      "line": 1,
      "link": "https://brakemanscanner.org/docs/warning_types/cross-site_request_forgery/",
      "code": null,
      "render_path": null,
      "location": {
        "type": "controller",
        "controller": "DomainSearchController"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "6a3c0484e1a62384d0fc9c68019db458140aa16600c874343ccc5a2fdeda1a35",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/cache/memcache/helpdesk/filters/custom_ticket_filter.rb",
      "line": 20,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "self.find(:all, :joins => \"JOIN admin_user_accesses acc ON acc.account_id =  wf_filters.account_id AND acc.accessible_id = wf_filters.id AND acc.accessible_type = 'Wf::Filter' LEFT JOIN agent_groups ON acc.group_id=agent_groups.group_id\", :order => \"created_at desc\", :conditions => ([\"acc.VISIBILITY=#{Admin::UserAccess::VISIBILITY_KEYS_BY_TOKEN[:all_agents]} OR agent_groups.user_id=#{user.id} OR (acc.VISIBILITY=#{Admin::UserAccess::VISIBILITY_KEYS_BY_TOKEN[:only_me]} and acc.user_id=#{user.id})\"]), :include => :accessible)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Cache::Memcache::Helpdesk::Filters::CustomTicketFilter",
        "method": "my_ticket_filters"
      },
      "user_input": "Admin::UserAccess::VISIBILITY_KEYS_BY_TOKEN[:all_agents]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "6acb1adb39ec5dea076dc685438566182d817a6f549bad9418738b62420554ee",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/shared/expanded/_ticket.html.erb",
      "line": 68,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t((\"ticket.ticket_user_list_status_\" + (Unresolved Model).new.ticket_states.current_state((Unresolved Model).new.outbound_email?)), :time_ago => time_ago_in_words((Unresolved Model).new.ticket_states.safe_send((Unresolved Model).new.ticket_states.current_state((Unresolved Model).new.outbound_email?))))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tags/show",
          "line": 67,
          "file": "app/views/helpdesk/tags/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/shared/expanded/_ticket"
      },
      "user_input": "(Unresolved Model).new.ticket_states",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "70085d050a3be53a08bd51c076a0d70774064ad4ccc2cad494da83ee448cdb0a",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/archive_note/attributes.rb",
      "line": 8,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::ArchiveNoteAssociation.new(options.merge(:archive_note_id => self.id))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ArchiveNote",
        "method": "archive_note_association_attributes="
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7807cf1d5f2752587d13edb7c0d2a3223a1fc19204d0ea2c7dc9613a84649cc6",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/controllers/helpdesk/leaderboard_controller.rb",
      "line": 85,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "current_account.safe_send((\"groups\" or \"all_users\")).where(\"id in (#{SupportScore.new(:group_id => params[:id]).get_leader_ids(current_account, params[:action], category, get_months_ago_value.month.ago(Time.now.in_time_zone(current_account.time_zone).end_of_month), 50).map(&:first).join(\",\")}) #{if (params[:action] == \"groups\") then\n  \"\"\nelse\n  \"and helpdesk_agent = 1 and deleted = 0\"\nend}\").order(\"FIELD(id, #{SupportScore.new(:group_id => params[:id]).get_leader_ids(current_account, params[:action], category, get_months_ago_value.month.ago(Time.now.in_time_zone(current_account.time_zone).end_of_month), 50).map(&:first).join(\",\")})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::LeaderboardController",
        "method": "generate_leaderboard"
      },
      "user_input": "SupportScore.new(:group_id => params[:id]).get_leader_ids(current_account, params[:action], category, get_months_ago_value.month.ago(Time.now.in_time_zone(current_account.time_zone).end_of_month), 50)",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "7b64f32576baecab0f71d9a4a431ca974cafaefa4a5b26d2f6bc5b11f2ed8d42",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/notes/agents_autocomplete.html.erb",
      "line": 10,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "load_agent_text(current_account.tickets.includes(:responder).find_by_display_id(params[:ticket_id]).responder).to_s",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "agents_autocomplete",
          "line": 128,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/notes/agents_autocomplete"
      },
      "user_input": "params[:ticket_id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7b7cc378655a5aec29cc478d958a8f19fea2e77268ec04b97c9d4048350a3f35",
      "message": "Possible SQL injection",
      "file": "lib/dashboard/leaderboard_methods.rb",
      "line": 178,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Account.current.safe_send(@module_association).where(:id => leader_modules.map(&:first), :helpdesk_agent => true, :deleted => false).order(\"FIELD(id, #{leader_modules.map(&:first)})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Dashboard::LeaderboardMethods",
        "method": "leader_module_scores"
      },
      "user_input": "leader_modules.map(&:first)",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "7d35fd8f71963ccc33ac163c018139de7d17892ac1e842a25c832e91f38f5a84",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/fdadmin/freshops_pod_controller.rb",
      "line": 44,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Integrations::HootsuiteRemoteUser.new(validate_integration_params(params[:hootsuite_remote_user]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Fdadmin::FreshopsPodController",
        "method": "create_hoot_suite_user"
      },
      "user_input": "params[:hootsuite_remote_user]",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "7d762f66749406e46c70f913df8f1ac6fb4c6bf24224f388c5ca26e005ebed79",
      "message": "Unescaped model attribute",
      "file": "app/views/integrations/hootsuite/tickets/_note.html.erb",
      "line": 60,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Integrations::Hootsuite::TicketsController",
          "method": "show",
          "line": 21,
          "file": "app/controllers/integrations/hootsuite/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "integrations/hootsuite/tickets/show",
          "line": 61,
          "file": "app/views/integrations/hootsuite/tickets/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "integrations/hootsuite/tickets/_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "824b646f056104d8fd64a6e1a73af255ddc3381cc0f499b31bceeb10f701e092",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/time_sheets/_integration.html.erb",
      "line": 9,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "render_timesheet_integrated_apps(\"requester\" => current_account.tickets.find_by_display_id(params[:ticket_id]).requester, \"ticket\" => current_account.tickets.find_by_display_id(params[:ticket_id]), \"agent\" => ((current_account.tickets.find_by_display_id(params[:ticket_id]).responder or current_user))).to_s",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TimeSheetsController",
          "method": "index",
          "line": 28,
          "file": "app/controllers/helpdesk/time_sheets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/time_sheets/index",
          "line": 17,
          "file": "app/views/helpdesk/time_sheets/index.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/time_sheets/_integration"
      },
      "user_input": "params[:ticket_id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "83ee91dac8f0cdb288fecb054a9e270a31df2bc22211ef7d7760b90f1e9e8dfb",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/helpdesk/process_email.rb",
      "line": 539,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::Ticket.new(build_ticket_params(account, get_user(account, ({} or orig_email_from_text), email_config, true), to_email, parse_all_cc_emails(account.kbase_email, account.support_emails), email_config))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ProcessEmail",
        "method": "create_ticket"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "84482290c6bfe135826f1d99d92b628f96ece3040595817ae31e9c539d4ed8a7",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/controllers/helpdesk/quests_controller.rb",
      "line": 9,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "current_user.achieved_quests.select(:quest_id).where(\"quest_id in (#{scoper.paginate(:page => params[:page], :per_page => 25).map(&:id).join(\",\")})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::QuestsController",
        "method": "index"
      },
      "user_input": "params[:page]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "8461e27ee6e20bfb40a539b37ae7ef0d573c35f5c22762ad16c209bed4496a5c",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/helpdesk/email/incoming_email_handler.rb",
      "line": 543,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::Ticket.new(build_ticket_params(account, get_user(account, ({} or orig_email_from_text), email_config, true), to_email, parse_all_cc_emails(account.kbase_email, account.support_emails), email_config))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Email::IncomingEmailHandler",
        "method": "create_ticket"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "85a3a1e306b9a715b48daf0ab984952a57d71db3b1a61e956dc7a7152cacf17e",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/contacts_controller.rb",
      "line": 312,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to(scoper.find(params[:id]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ContactsController",
        "method": "make_occasional_agent"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "8775787bb243452768b61f662dcb9a5acfd282e017e945ea05af9913086fade6",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/ticket/attributes.rb",
      "line": 20,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::TicketBody.new(options)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticket",
        "method": "ticket_body_attributes="
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "8802418d3533acaa180b44ed2079e8c6c768512b14f1ee36ba78a61f484bcebb",
      "message": "Unescaped model attribute",
      "file": "app/views/integrations/hootsuite/tickets/_note.html.erb",
      "line": 43,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"helpdesk.tickets.note.created_on_live.#{(Unresolved Model).new.kind}\", :user_name => link_to_user((Unresolved Model).new.user), :note_date => formated_date((Unresolved Model).new.created_at), :timestamp => (Unresolved Model).new.created_at.to_i)",
      "render_path": [
        {
          "type": "controller",
          "class": "Integrations::Hootsuite::TicketsController",
          "method": "show",
          "line": 21,
          "file": "app/controllers/integrations/hootsuite/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "integrations/hootsuite/tickets/show",
          "line": 61,
          "file": "app/views/integrations/hootsuite/tickets/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "integrations/hootsuite/tickets/_note"
      },
      "user_input": "(Unresolved Model).new.kind",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "881916c0aaf70b957ddbb3933b5f0a49bc948ec34285799178006746c4e672b0",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_custom_survey_note.html.erb",
      "line": 45,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "index",
          "line": 39,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/tickets/show/_conversations.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_note",
          "line": 193,
          "file": "app/views/helpdesk/tickets/show/_note.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_custom_survey_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "881916c0aaf70b957ddbb3933b5f0a49bc948ec34285799178006746c4e672b0",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_custom_survey_note.html.erb",
      "line": 41,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "index",
          "line": 39,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/tickets/show/_conversations.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_note",
          "line": 193,
          "file": "app/views/helpdesk/tickets/show/_note.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_custom_survey_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "88967f45ac3c67681f257ce854dc5c6b736cdf87b89b10bf423d6ea4f9fe5a25",
      "message": "Possible SQL injection",
      "file": "app/models/custom_survey/survey_result.rb",
      "line": 51,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scope(:aggregate, lambda do\n { :select => (\"`survey_results`.id, `survey_results`.survey_id, \\n                    survey_result_data.#{condition[:column_name]} as rating, count(*) as total\"), :joins => \"INNER JOIN `survey_result_data` ON\\n                  `survey_result_data`.`survey_result_id` = `survey_results`.`id` AND\\n                    `survey_result_data`.`account_id` = `survey_results`.`account_id`\", :group => (\"survey_result_data.#{condition[:column_name]}\"), :order => (\"survey_result_data.#{condition[:column_name]}\"), :conditions => ([\"survey_results.survey_id = ? \\n                        and survey_results.created_at between ? and ?\", condition[:survey_id], condition[:start_date], condition[:end_date]]) }\n end)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "CustomSurvey::SurveyResult",
        "method": null
      },
      "user_input": "condition[:column_name]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "88c584c7ee88e1623a469af154cdd39a133a2aecfcb90f360773db3e593f67c5",
      "message": "Possible SQL injection",
      "file": "lib/sync/sql_util.rb",
      "line": 21,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "ActiveRecord::Base.connection.execute(\"DELETE from #{table_name} where id = #{id}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sync::SqlUtil",
        "method": "delete_record"
      },
      "user_input": "table_name",
      "confidence": "Medium",
      "note": "Required for Cloning"
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "8aafa6ef714a716fb8f55180f73a506cfaec1103b76b1e4b4a3188122283b165",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/sync/file_to_data/post_migration.rb",
      "line": 66,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "ActiveRecord::Base.connection.execute(\"DELETE from #{model_table_mapping[association]} where #{reference[1]} IN (#{deleted_associations[reference[0]]})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sync::FileToData::PostMigration",
        "method": "delete_agent_references"
      },
      "user_input": "model_table_mapping[association]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "8b5d0b244eb392141c0ed63068d3a1b15f3b19c82c7a1c5a9648428288f7951c",
      "message": "Possible SQL injection",
      "file": "lib/search/recent_tickets.rb",
      "line": 27,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Account.current.archive_tickets.where(:display_id => (super)).select(\"archive_tickets.display_id, archive_tickets.subject\").order(\"field(display_id, #{super.join(\",\")})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Search::RecentTickets",
        "method": "recent"
      },
      "user_input": "super.join(\",\")",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "8d1e388936d68eb8c035c4cc09e85e9154d0405c8f8735ed5871c7457539d205",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/fdadmin/freshops_pod_controller.rb",
      "line": 50,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Integrations::ShopifyRemoteUser.new(validate_integration_params(params[:shopify_remote_user]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Fdadmin::FreshopsPodController",
        "method": "create_shopify_user"
      },
      "user_input": "params[:shopify_remote_user]",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "8e71e83411a59283b070dacf74b1af14713d0c7b7bd6dcfd87e47ec4e236970a",
      "message": "Possible SQL injection",
      "file": "app/models/wf/filter.rb",
      "line": 707,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Wf::Filter.find(:all, :conditions => ((([\"type = ? and model_class_name = ?\", self.class.name, self.model_class_name] or [\"model_class_name = ?\", self.model_class_name]) << Wf::Config.current_user.id) << \"0\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Wf::Filter",
        "method": "saved_filters"
      },
      "user_input": "(([\"type = ? and model_class_name = ?\", self.class.name, self.model_class_name] or [\"model_class_name = ?\", self.model_class_name]) << Wf::Config.current_user.id)",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "910a387b85a87226b97d9b6ce8fc02a71ce29345f8a005c036da942379123382",
      "message": "Unescaped parameter value",
      "file": "app/views/integrations/hootsuite/tickets/_original_request.html.erb",
      "line": 55,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "scoper.find_by_display_id(params[:id]).description_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Integrations::Hootsuite::TicketsController",
          "method": "show",
          "line": 21,
          "file": "app/controllers/integrations/hootsuite/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "integrations/hootsuite/tickets/show",
          "line": 46,
          "file": "app/views/integrations/hootsuite/tickets/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "integrations/hootsuite/tickets/_original_request"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "9139481cde03666da2a72a99a0c10c7769e93c79674d659158859581ffddbb64",
      "message": "Unescaped parameter value",
      "file": "app/views/admin/email_notifications/_helpnote.html.erb",
      "line": 2,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"email_notifications.helpcard.#{params[:type]}_#{scoper.find_by_id(params[:id]).notification_type.to_s}.info1\")",
      "render_path": [
        {
          "type": "controller",
          "class": "Admin::EmailNotificationsController",
          "method": "edit",
          "line": 55,
          "file": "app/controllers/admin/email_notifications_controller.rb"
        },
        {
          "type": "template",
          "name": "admin/email_notifications/edit",
          "line": 518,
          "file": "app/views/admin/email_notifications/edit.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "admin/email_notifications/_helpnote"
      },
      "user_input": "params[:type]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "94171724271279084f0a1e3c641fa1b332fdc040abd379056b708db3f5a7840a",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket_state.rb",
      "line": 334,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"UPDATE #{stats_table(@resolved_time_was)} SET #{reopen_stats} where ticket_id = #{ticket_id} and \\n        account_id = #{account_id} and created_at = '#{@resolved_time_was.strftime(\"%Y-%m-%d 00:00:00\")}'\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::TicketState",
        "method": "update_resolved_date_stats"
      },
      "user_input": "stats_table(@resolved_time_was)",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "967d84ab8f39526d177bf16ca90de92c9adee575176cf2aa2f24d98b17181d10",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_custom_activity.html.erb",
      "line": 29,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.system_activity_timestamp\", :system_rule => link_to_system_rule((Unresolved Model).new.rule), :timestamp => format_activity_date((Unresolved Model).new.performed_time, true).to_i, :note_date => formated_date(format_activity_date((Unresolved Model).new.performed_time, true)))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tickets/activitiesv2",
          "line": 3,
          "file": "app/views/helpdesk/tickets/activitiesv2.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_custom_activity"
      },
      "user_input": "(Unresolved Model).new.performed_time",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "990d5a9c07110b794a8aa19015139aacd789c5f0262da862ff00eaee6bc5d585",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_custom_activity.html.erb",
      "line": 27,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.user_activity_timestamp\", :user_name => link_to_user((Unresolved Model).new.performer, :class => \"user_name\"), :timestamp => format_activity_date((Unresolved Model).new.performed_time, true).to_i, :note_date => formated_date(format_activity_date((Unresolved Model).new.performed_time, true)))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tickets/activitiesv2",
          "line": 3,
          "file": "app/views/helpdesk/tickets/activitiesv2.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_custom_activity"
      },
      "user_input": "(Unresolved Model).new.performed_time",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "992bba6c77b275c62cd47efc1df34785b5c327ef334e11dc0edefa549f9385f8",
      "message": "Unescaped model attribute",
      "file": "app/views/integrations/applications/github_settings.html.erb",
      "line": 13,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"integrations.#{Integrations::Application.find_by_name(APP_NAME).name}.helptext\")",
      "render_path": [
        {
          "type": "controller",
          "class": "Integrations::GithubController",
          "method": "new",
          "line": 20,
          "file": "app/controllers/integrations/github_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "integrations/applications/github_settings"
      },
      "user_input": "Integrations::Application.find_by_name(APP_NAME).name",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "9c09f01f3edfd7ffe369cbf1d9cbe67e6bede35d6b65ee98304adb9b5e971914",
      "message": "Possible SQL injection",
      "file": "lib/sync/sql_util.rb",
      "line": 29,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "ActiveRecord::Base.connection.execute((\"select (1) from #{table_name} where id = #{id} and account_id = #{account_id}\" + \" and deleted = 0\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sync::SqlUtil",
        "method": "record_present?"
      },
      "user_input": "table_name",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "9d5343c7e920b1611ceca784a805311eb072e749b5b96a0e50ad10ca5c058985",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/shared/expanded/_ticket.html.erb",
      "line": 62,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.ticket_from\", :username => requester((Unresolved Model).new))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/tags/show",
          "line": 67,
          "file": "app/views/helpdesk/tags/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/shared/expanded/_ticket"
      },
      "user_input": "(Unresolved Model).new",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 25,
      "fingerprint": "9d7831d5b13c184a3019cc6852855b6e8290fe9bfc660fc4c0f075f7a77dcabb",
      "check_name": "Deserialize",
      "message": "YAML.load called with model attribute",
      "file": "app/models/helpdesk/archive_ticket.rb",
      "line": 573,
      "link": "http://brakemanscanner.org/docs/warning_types/unsafe_deserialization",
      "code": "YAML.load(self.archive_notes.find_by_source(Account.current.helpdesk_sources.note_source_keys_by_token[\"meta\"]).body)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ArchiveTicket",
        "method": "outbound_initiator"
      },
      "user_input": "Account.current.helpdesk_sources",
      "confidence": "Medium",
      "note": "previously ignored"
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "9effebdfbf0a43564c54ecf31e0f5bc024e73ed43010456796c5b4e85a069c11",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "lib/helpdesk/initializers/githooks.rb",
      "line": 6,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`rm \"#{Rails.root}/.git/hooks/#{script_name}\"`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GitHooksInit",
        "method": "s(:self).link_script"
      },
      "user_input": "script_name",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "a1873820966713bd807cd27bfb511754e39e242b077098356963365c70b9ef32",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/support/notes_controller.rb",
      "line": 24,
      "link": "http://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::Ticket.find_by_param(params[:ticket_id], current_account).notes.build({ \"incoming\" => true, \"private\" => false, \"source\" => current_account.helpdesk_sources.note_source_keys_by_token[\"note\"], \"user_id\" => ((current_user and current_user.id)), \"account_id\" => ((current_account and current_account.id)) }.merge(params[:helpdesk_note].permit(*[{ :attachments => ([:resource]) }, { :inline_attachment_ids => ([]) }, { :note_body_attributes => ([:body_html]) }])))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Support::NotesController",
        "method": "create"
      },
      "user_input": "params[:helpdesk_note].permit(*[{ :attachments => ([:resource]) }, { :inline_attachment_ids => ([]) }, { :note_body_attributes => ([:body_html]) }])",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "a3c91a25465f52ca16fa2470c213227e5a1a30d609b7ded97efe2ca1a170d211",
      "message": "Model attribute used in file name",
      "file": "lib/helpdesk/export_data_worker.rb",
      "line": 19,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.mkdir_p(\"#{Rails.root}/tmp/#{Account.find_by_full_domain(params[:domain]).id}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ExportDataWorker",
        "method": "perform"
      },
      "user_input": "Account.find_by_full_domain(params[:domain])",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "a4020ce8ae55dc81ee3f563fe3adf6b215ad3c2feb78154860ef55023830c5a6",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_activity.html.erb",
      "line": 43,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new[:stack].size",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/activities",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/activities.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_activity"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 25,
      "fingerprint": "a4d06848242d663fdefbc8f030cf546998c561483b367be3f1424454f81b535b",
      "check_name": "Deserialize",
      "message": "YAML.load called with model attribute",
      "file": "app/models/helpdesk/ticket.rb",
      "line": 582,
      "link": "http://brakemanscanner.org/docs/warning_types/unsafe_deserialization",
      "code": "YAML.load(self.notes.find_by_source(Account.current.helpdesk_sources.note_source_keys_by_token[\"meta\"]).body)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticket",
        "method": "outbound_initiator"
      },
      "user_input": "Account.current.helpdesk_sources",
      "confidence": "Medium",
      "note": "previously ignored"
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "a521b6369cbef5e81769e72bd8727692efba8c6c34d9d16cd4986fa9909d48d2",
      "message": "Unescaped parameter value",
      "file": "app/views/public/tickets/_ticket.html.erb",
      "line": 25,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "current_account.schema_less_tickets.find_by_access_token(params[:id]).ticket.description_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Public::TicketsController",
          "method": "show",
          "line": 11,
          "file": "app/controllers/public/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "public/tickets/show",
          "line": 4,
          "file": "app/views/public/tickets/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "public/tickets/_ticket"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "a573bca956dcb99b364da08aebc8f5559b7c3cf80a81a8dbee84d54d8f839157",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/note.rb",
      "line": 116,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "scope(:broadcast_notes, :joins => \"INNER JOIN helpdesk_schema_less_notes on helpdesk_schema_less_notes.note_id = helpdesk_notes.id and helpdesk_notes.account_id = helpdesk_schema_less_notes.account_id\", :conditions => ([\"notable_type = ? and deleted = 0 and helpdesk_schema_less_notes.#{Helpdesk::SchemaLessNote.category_column} = ?\", \"Helpdesk::Ticket\", Helpdesk::Note::CATEGORIES[:broadcast]]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Note",
        "method": null
      },
      "user_input": "Helpdesk::SchemaLessNote.category_column",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "a5de1dc9719d990e0afb97270636f2ba8815b048aab0d93d636271cee2135a04",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_activity.html.erb",
      "line": 15,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t((\"activities.tag.\" + (Unresolved Model).new[:important][:type]), :value => (Unresolved Model).new[:important][:value])",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/activities",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/activities.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_activity"
      },
      "user_input": "(Unresolved Model).new[:important]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "aa6ba2371bb8a0125728e35c49c23c5aecec75bca58be920b1babfeb2328ef25",
      "message": "Model attribute used in file name",
      "file": "lib/helpdesk_reports/export/utils.rb",
      "line": 69,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.mkdir_p(\"#{Rails.root}/tmp/export/#{Account.current.id}/#{type}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "HelpdeskReports::Export::Utils",
        "method": "generate_file_path"
      },
      "user_input": "Account.current",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "aafb075015879b5acb89068a8074049d551d6c2f190a31dee9b1e70eef0b2a34",
      "message": "Model attribute used in file name",
      "file": "lib/export/util.rb",
      "line": 67,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.mkdir_p(\"#{Rails.root}/tmp/export/#{Account.current.id}/#{type}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Export::Util",
        "method": "generate_file_path"
      },
      "user_input": "Account.current",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "acf4771f1f60f1e077c33f9c9060d5a31cba8b39819796bfe2280fcf0584c374",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/collab_tickets/show/_original_request.html.erb",
      "line": 74,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "current_account.tickets.find_by_display_id(params[:id]).description_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::CollabTicketsController",
          "method": "show",
          "line": 17,
          "file": "app/controllers/helpdesk/collab_tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show",
          "line": 37,
          "file": "app/views/helpdesk/collab_tickets/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/collab_tickets/show/_original_request"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "acf4a5be1d820f3c36c1239360d8362d3e7b957eef1242ebe51326da6e0b5b2f",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/fdadmin/freshops_pod_controller.rb",
      "line": 70,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Integrations::SlackRemoteUser.new(validate_integration_params(params[:slack_remote_user]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Fdadmin::FreshopsPodController",
        "method": "create_slack_user"
      },
      "user_input": "params[:slack_remote_user]",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "ad70060f4746cca723269139d40c63140b67dbd26d6a6f7b064140d7b0ba1856",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/support/discussions/posts_controller.rb",
      "line": 107,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Post.find_by_id_and_topic_id(params[:id], params[:topic_id]).cloud_files.create(build_cloud_files(attachment_json))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Support::Discussions::PostsController",
        "method": "create_attachments"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "ae94ba31170ce79947bfc6d9a822c40818f83be5347bd2a919a532935c37c8b5",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_activity.html.erb",
      "line": 19,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.activity_timestamp\", :user_name => link_to_user((Unresolved Model).new[:user], :class => \"user_name\"), :timestamp => (Unresolved Model).new[:time].to_i, :note_date => formated_date((Unresolved Model).new[:time]))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/activities",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/activities.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_activity"
      },
      "user_input": "(Unresolved Model).new[:time]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "aeaa73e530fa5006cc0d1eb5f5e18cb521852a55a6c953961ea9eedc29c32aed",
      "message": "Parameter value used in file name",
      "file": "lib/import/zen/file_util.rb",
      "line": 71,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "Net::HTTP.new(URI.parse(((params[:zendesk][:url] + \"/\") + file_name)).host, URI.parse(((params[:zendesk][:url] + \"/\") + file_name)).port)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Import::Zen::FileUtil",
        "method": "import_file"
      },
      "user_input": "((params[:zendesk][:url] + \"/\") + file_name)",
      "confidence": "Weak",
      "note": "Zendesk import functionality is no longer in use. This code will not get executed."
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "b09c836e8e04dfac8a25dbf05df8a7a45e1b99b0b00e1d7907755979375bca26",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/company_field.rb",
      "line": 92,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "CompanyField.new(field_data)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "CompanyField",
        "method": "CompanyField.create_company_field"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "b4ad395c833d72eb9aa7e51c64106170561a0790d1803e6601737014ad5f9352",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/agent.rb",
      "line": 79,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Agent.where(:id => self.id).update_all(\"points = #{score}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Agent",
        "method": "change_points"
      },
      "user_input": "score",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "ba4275e03da9df48ff4bfc00bee87f0eaace0f77f61354e02661c2c18d30aad7",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/ticket/association_methods.rb",
      "line": 280,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "self.update_attributes((if self[:link_feature_disable] then\n  self.schema_less_ticket.additional_info.delete(:subsidiary_tkts_count)\n  { :association_type => nil }\nelse\n  { :subsidiary_tkts_count => self.related_tickets_count }\nend))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticket",
        "method": "nullify_tracker_associates"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "bdd1b4cdc861d42306bf72f37dba2840f5ea8e4993f6b056e5c6f1147e689495",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/helpdesk/adjacent_tickets.rb",
      "line": 44,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "current_account.tickets.find(:first, :conditions => ([\"id #{{ :prev => ({ :sql_operator => \"<\", :order => \"DESC\", :list_push => \"left\", :which_end => \"last\", :list_index_operator => \"-\" }), :next => ({ :sql_operator => \">\", :order => \"ASC\", :list_push => \"right\", :which_end => \"first\", :list_index_operator => \"+\" }) }[direction][:sql_operator]} ? \\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tAND deleted = 0 AND spam = 0 \", @item.id]), :order => (\"id #{{ :prev => ({ :sql_operator => \"<\", :order => \"DESC\", :list_push => \"left\", :which_end => \"last\", :list_index_operator => \"-\" }), :next => ({ :sql_operator => \">\", :order => \"ASC\", :list_push => \"right\", :which_end => \"first\", :list_index_operator => \"+\" }) }[direction][:order]}\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::AdjacentTickets",
        "method": "find_in_all"
      },
      "user_input": "{ :prev => ({ :sql_operator => \"<\", :order => \"DESC\", :list_push => \"left\", :which_end => \"last\", :list_index_operator => \"-\" }), :next => ({ :sql_operator => \">\", :order => \"ASC\", :list_push => \"right\", :which_end => \"first\", :list_index_operator => \"+\" }) }[direction][:sql_operator]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "be16a44a4dc18f26325278a115be60a67479b3e354266fe6f61a452a915a18cf",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/_archive_note.html.erb",
      "line": 28,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\".posted_on\", :user_name => link_to_user((Unresolved Model).new.user), :note_date => formated_date((Unresolved Model).new.created_at))",
      "render_path": [
        {
          "type": "controller",
          "class": "Public::TicketsController",
          "method": "show",
          "line": 11,
          "file": "app/controllers/public/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "public/tickets/show",
          "line": 2,
          "file": "app/views/public/tickets/show.html.erb"
        },
        {
          "type": "template",
          "name": "public/tickets/_archived_ticket",
          "line": 44,
          "file": "app/views/public/tickets/_archived_ticket.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/_archive_note"
      },
      "user_input": "(Unresolved Model).new.created_at",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "be564ee1672036d5561aa22ebbd93fceecddbdab3c89e59e518d380f290d2cb1",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/filters/custom_ticket_filter.rb",
      "line": 146,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Admin::UserAccess.new({ :account_id => account_id }.merge(self.visibility))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Filters::CustomTicketFilter",
        "method": "create_accesible"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "c19e443e112ed9f02e2bb66ef86cc6c02a45c0dd1a08b25e7f9a3db969aabf09",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/fdadmin/freshops_pod_controller.rb",
      "line": 60,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Integrations::QuickbooksRemoteUser.new(validate_integration_params(params[:quickbooks_remote_user]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Fdadmin::FreshopsPodController",
        "method": "create_quickbooks_user"
      },
      "user_input": "params[:quickbooks_remote_user]",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "c42042670e53c642a157725235a2ff3875263dc136f015c9352975de4c28e9ac",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/_note.html.erb",
      "line": 63,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "index",
          "line": 41,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "c71b95bc52357840c011ac256ec06cc87da0d377096bdfcbf223c895a1e8275b",
      "message": "Unescaped parameter value",
      "file": "app/views/integrations/hootsuite/tickets/show.html.erb",
      "line": 52,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"integrations.hootsuite.notes_more\", :count => (scoper.find_by_display_id(params[:id]).conversation_count - 1))",
      "render_path": [
        {
          "type": "controller",
          "class": "Integrations::Hootsuite::TicketsController",
          "method": "show",
          "line": 21,
          "file": "app/controllers/integrations/hootsuite/tickets_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "integrations/hootsuite/tickets/show"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "c785b6f4e03f84cba92ad7b0fd194f2e6eedd7ce88aa01d4aa105ebbf7bb35d9",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/ticket/callbacks.rb",
      "line": 662,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "account.company_domains.where(\"domain = '#{/@(.+)/.match(self.from_email).to_a[1]}'\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticket",
        "method": "set_company_id"
      },
      "user_input": "/@(.+)/.match(self.from_email).to_a[1]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "cd03c6ffb5ecd29bb17ee39c095cacc2959f5d326ab3d383852c4995b32ab3c2",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_survey_note.html.erb",
      "line": 5,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::ArchiveNotesController",
          "method": "index",
          "line": 20,
          "file": "app/controllers/helpdesk/archive_notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/show/_conversations.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/show/_note",
          "line": 113,
          "file": "app/views/helpdesk/archive_tickets/show/_note.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_survey_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ceea98b4f1722489009da749e56a2dccd10e7dcc830ab20b9f5c82bb94d3e2a0",
      "message": "Possible SQL injection",
      "file": "lib/search/recent_tickets.rb",
      "line": 16,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Account.current.tickets.where(:display_id => (super)).select(\"helpdesk_tickets.display_id, helpdesk_tickets.subject\").order(\"field(display_id, #{super.join(\",\")})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Search::RecentTickets",
        "method": "recent"
      },
      "user_input": "super.join(\",\")",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "cfd445a96cc31c44eb12e43e786e238c5bdca5989728cc4a912618ed9fe28a07",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/subscription.rb",
      "line": 666,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "self.billing_address.update_attributes(address(card))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Subscription",
        "method": "update_billing_address"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "d04d4d4b1d1411319c9b251d31562e158395e7e15c4ca8998b68f1269490c5d5",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/admin/mobihelp/apps_controller.rb",
      "line": 63,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Mobihelp::App.new.attributes = params[:mobihelp_app]",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Admin::Mobihelp::AppsController",
        "method": "build_mobihelp_app"
      },
      "user_input": "params[:mobihelp_app]",
      "confidence": "Medium",
      "note": "Mobihelp is not supported anymore . This need not be fixed. There is permission elevation possible with this mass assignment."
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "d1c8285a1e114c65d856b7a34fc44deeaaa668ccd0ea3cbbd7d3b259aa804025",
      "message": "Unescaped parameter value",
      "file": "app/views/integrations/cti/screen_pop/_requester_info.html.erb",
      "line": 10,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "requester_namecard_render(current_account.all_users.find(params[:requester_id]))",
      "render_path": [
        {
          "type": "controller",
          "class": "Integrations::Cti::ScreenPopController",
          "method": "contact_details",
          "line": 13,
          "file": "app/controllers/integrations/cti/screen_pop_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "integrations/cti/screen_pop/_requester_info"
      },
      "user_input": "params[:requester_id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "d7dbb695efc7c55692bd6fc6a60d08242db24c3b83988b71066c08503f69a310",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_survey_note.html.erb",
      "line": 8,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::NotesController",
          "method": "index",
          "line": 39,
          "file": "app/controllers/helpdesk/notes_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/tickets/show/_conversations.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/show/_note",
          "line": 196,
          "file": "app/views/helpdesk/tickets/show/_note.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_survey_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "d8a03a0ced4edf60c547436d80d4dca492b77bc00a2af13b691f8882a7591bbc",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/collab_tickets/show/_custom_survey_note.html.erb",
      "line": 38,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show",
          "line": 52,
          "file": "app/views/helpdesk/collab_tickets/show.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/collab_tickets/show/_conversations.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show/_note",
          "line": 100,
          "file": "app/views/helpdesk/collab_tickets/show/_note.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/collab_tickets/show/_custom_survey_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "d8a03a0ced4edf60c547436d80d4dca492b77bc00a2af13b691f8882a7591bbc",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/collab_tickets/show/_custom_survey_note.html.erb",
      "line": 42,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show",
          "line": 52,
          "file": "app/views/helpdesk/collab_tickets/show.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/collab_tickets/show/_conversations.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show/_note",
          "line": 100,
          "file": "app/views/helpdesk/collab_tickets/show/_note.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/collab_tickets/show/_custom_survey_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "dabcc7aa6e2536b33f0c4c8ce22ccf1bc1fb5deb5eeee2ff5d0634a6f6657df6",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/canned_responses/folders/_show.html.erb",
      "line": 4,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "each_or_message(\"ca_response\", visible_responses(scoper.find_by_id(params[:id])), t(\"canned_folders.no_response_admin\", :link => new_helpdesk_canned_responses_folder_response_path(scoper.find_by_id(params[:id]))), :f => f)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::CannedResponses::FoldersController",
          "method": "show",
          "line": 22,
          "file": "app/controllers/helpdesk/canned_responses/folders_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/canned_responses/folders/index",
          "line": 145,
          "file": "app/views/helpdesk/canned_responses/folders/index.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/canned_responses/folders/_show"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "dad6a1974ecee316456b0d27547df28e5abbab869d7a13c68480094dbec071a7",
      "message": "Possible SQL injection",
      "file": "app/models/support_score.rb",
      "line": 57,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "from(\"#{self.table_name} FORCE INDEX(#{index})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "SupportScore",
        "method": "force_index"
      },
      "user_input": "index",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "dc669d0655f56fd4af970e57626bcd3704df42ed8ccb12c14a22ed46e9fc30a0",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/archive_ticket/attributes.rb",
      "line": 8,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::ArchiveTicketAssociation.new(options.merge(:archive_ticket_id => self.id))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ArchiveTicket",
        "method": "archive_ticket_association_attributes="
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "dee8fcea81c5fed12ccda999b8db62a7612f9a31fba9d63e1e036dee8cdeddbf",
      "message": "Possible command injection",
      "file": "lib/sync/git_client.rb",
      "line": 204,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`#{command}`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sync::GitClient",
        "method": "execute_command"
      },
      "user_input": "command",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "df150cd257b31c0d069d69d246fbd9033e75e817387cfedb8572c2cd85a0cedc",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/helpdesk/ticketfields/controller_methods.rb",
      "line": 25,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "FlexifieldDefEntry.new(ff_meta_data(nested_field, account))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticketfields::ControllerMethods",
        "method": "create_field"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "df306c0e4405973cd325cd4f3d2723ceb706f13d3bdee1d2913226150d7232c0",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/collab_tickets/show/_note.html.erb",
      "line": 77,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"helpdesk.tickets.note.created_on_live.#{((Unresolved Model).new.kind or \"survey\")}\", :user_name => link_to_user((Unresolved Model).new.user), :note_date => formated_date((Unresolved Model).new.created_at), :timestamp => (Unresolved Model).new.created_at.to_i)",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::CollabTicketsController",
          "method": "show",
          "line": 17,
          "file": "app/controllers/helpdesk/collab_tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show",
          "line": 52,
          "file": "app/views/helpdesk/collab_tickets/show.html.erb"
        },
        {
          "type": "template",
          "name": "helpdesk/collab_tickets/show/_conversations",
          "line": 3,
          "file": "app/views/helpdesk/collab_tickets/show/_conversations.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/collab_tickets/show/_note"
      },
      "user_input": "(Unresolved Model).new.kind",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "e3443296030e7b13e80395667c001441090123cf81d8e520ea4a76490b9e52c4",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/controllers/helpdesk/tickets_controller.rb",
      "line": 144,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "current_account.tickets.visible.preload(:requester, :ticket_status, :ticket_body).permissible(current_user).reorder(\"field(helpdesk_tickets.id,#{get_similar_tickets.join(\",\")})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::TicketsController",
        "method": "suggest_tickets"
      },
      "user_input": "get_similar_tickets.join(\",\")",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "e403236dedbf40bc077edf70d04829d18ce172e49ecfae632f193985195bfd56",
      "message": "Possible SQL injection",
      "file": "lib/reports/archive_data.rb",
      "line": 48,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "ActiveRecord::Base.connection.select_all(\" select #{select_aggregate_columns}, #{select_def_columns([])} from #{join_query([])}  where #{conditions(account.id)} group by #{select_def_columns([])}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::ArchiveData",
        "method": "load_archive_data"
      },
      "user_input": "select_aggregate_columns",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "e7877236cc929b3ed83f075c46b1b8ace9d9b0ffded82e89f3513524de6b0ef5",
      "message": "Render path contains parameter value",
      "file": "app/controllers/integrations/cloud_elements/crm_controller.rb",
      "line": 148,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => { @cloud_elements_obj.web_meta.delete(:content_type) => (((service_obj(JSON.parse(params[:payload], :symbolize_names => true), ({ :user_agent => request.user_agent, :app_name => element } or { :user_agent => request.user_agent, :app_name => element, :element_token => current_account.installed_applications.find_by_application_id(app.id).configs_element_token, :object => get_crm_constants[\"objects\"][JSON.parse(params[:payload], :symbolize_names => true)[:type]], :object_id => get_crm_constants[\"Id\"] })).receive(\"#{params[:event]}\".to_sym) or get_contact_account_name(service_obj(JSON.parse(params[:payload], :symbolize_names => true), ({ :user_agent => request.user_agent, :app_name => element } or { :user_agent => request.user_agent, :app_name => element, :element_token => current_account.installed_applications.find_by_application_id(app.id).configs_element_token, :object => get_crm_constants[\"objects\"][JSON.parse(params[:payload], :symbolize_names => true)[:type]], :object_id => get_crm_constants[\"Id\"] })).receive(\"#{params[:event]}\".to_sym), ({ :user_agent => request.user_agent, :app_name => element } or { :user_agent => request.user_agent, :app_name => element, :element_token => current_account.installed_applications.find_by_application_id(app.id).configs_element_token, :object => get_crm_constants[\"objects\"][JSON.parse(params[:payload], :symbolize_names => true)[:type]], :object_id => get_crm_constants[\"Id\"] }))) or (get_contact_accounts(JSON.parse(params[:payload], :symbolize_names => true)) or service_obj(JSON.parse(params[:payload], :symbolize_names => true), ({ :user_agent => request.user_agent, :app_name => element } or { :user_agent => request.user_agent, :app_name => element, :element_token => current_account.installed_applications.find_by_application_id(app.id).configs_element_token, :object => get_crm_constants[\"objects\"][JSON.parse(params[:payload], :symbolize_names => true)[:type]], :object_id => get_crm_constants[\"Id\"] })).receive(\"#{params[:event]}\".to_sym)))) }, {})",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Integrations::CloudElements::CrmController",
        "method": "fetch"
      },
      "user_input": "params[:event]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "e893b31f3f22e77c7870f26c4572e38cac8ddb614889e7c83783c44fbf752a23",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/integrations/marketplace/shopify_controller.rb",
      "line": 82,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to((AppConfig[\"integrations_url\"][Rails.env] + \"/auth/shopify?shop=#{(params[:remote_id] or Integrations::ShopifyRemoteUser.where(:account_id => current_account.id).first.remote_id)}&origin=id%3D#{current_account.id.to_s}\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Integrations::Marketplace::ShopifyController",
        "method": "landing"
      },
      "user_input": "Integrations::ShopifyRemoteUser.where(:account_id => current_account.id).first.remote_id",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "e8cdaafeac4141e15bad6ff7f54853783e4ebdb91d9ff7a79f332b33433a8c0a",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/_archive_note.html.erb",
      "line": 46,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "(Unresolved Model).new.body_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Public::TicketsController",
          "method": "show",
          "line": 11,
          "file": "app/controllers/public/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "public/tickets/show",
          "line": 2,
          "file": "app/views/public/tickets/show.html.erb"
        },
        {
          "type": "template",
          "name": "public/tickets/_archived_ticket",
          "line": 44,
          "file": "app/views/public/tickets/_archived_ticket.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/_archive_note"
      },
      "user_input": null,
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "e9d41b83ae538cdacdb55bb8faacc7aed8412892b723be1cccf5f6c629506f6e",
      "message": "Unescaped parameter value",
      "file": "app/views/helpdesk/tickets/show/_ticket_association.html.erb",
      "line": 30,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t((\"ticket.ticket_user_list_status_\" + load_by_param(params[:id]).associated_prime_ticket(\"related\").ticket_states.current_state(load_by_param(params[:id]).outbound_email?)), :time_ago => time_ago_in_words(load_by_param(params[:id]).associated_prime_ticket(\"related\").ticket_states.safe_send(load_by_param(params[:id]).associated_prime_ticket(\"related\").ticket_states.current_state(load_by_param(params[:id]).associated_prime_ticket(\"related\").outbound_email?))))",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "ticket_association",
          "line": 1054,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_ticket_association"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "ea5f87077636a5afdef0353842a844d90f1f1ba38ffd02bf3047239d6a91cfe4",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "lib/spam/core/base.rb",
      "line": 84,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::Ticket.new(model.associations_data[:helpdesk_tickets]).notes.build(note.associations_data[:helpdesk_notes]).safe_send(key).build(value)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Spam::Core::Base",
        "method": "restore_tickets_and_notes"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "edd34c903ca8e3d40a70aa75026ce7ed27a311e08513ce6e3f08b7708621a98d",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/cache/memcache/account.rb",
      "line": 540,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "self.installed_applications.includes(:application).where(\"applications.dip & #{(2 ** Integrations::Constants::DISPLAY_IN_PAGES[\"company_show\"])} > 0\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Cache::Memcache::Account",
        "method": "installed_apps_in_company_page_from_cache"
      },
      "user_input": "(2 ** Integrations::Constants::DISPLAY_IN_PAGES[\"company_show\"])",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ee2087d056f3692f2db44184e63ae74300732fc06f1485b2a5fc1cb63956ffed",
      "message": "Possible SQL injection",
      "file": "app/models/helpdesk/archive_ticket.rb",
      "line": 114,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "self.where(\"archive_tickets.requester_id = ? #{operator} archive_tickets.owner_id in (?)\", user_id, company_ids)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ArchiveTicket",
        "method": null
      },
      "user_input": "operator",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ee8b631eb2a55cb7de632a58ca384af2e632a226f844da737f29b834341a43bf",
      "message": "Possible SQL injection",
      "file": "lib/saas/account_data_cleanup.rb",
      "line": 311,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "ActiveRecord::Base.connection.execute(\"\\n        INSERT INTO contact_fields (#{{ :account_id => account.id, :contact_form_id => account.contact_form.id, :name => \"unique_external_id\", :column_name => \"default\", :label => \"Unique External Id\", :label_in_portal => \"Unique External Id\", :deleted => 0, :field_type => ContactField::DEFAULT_FIELD_PROPS[:default_unique_external_id][:type], :position => account.contact_form.contact_fields.length, :required_for_agent => 0, :visible_in_portal => 0, :editable_in_portal => 0, :editable_in_signup => 0, :required_in_portal => 0, :created_at => Time.now.to_s(:db), :updated_at => Time.now.to_s(:db) }.keys.join(\",\")}) VALUES\\n        (#{{ :account_id => account.id, :contact_form_id => account.contact_form.id, :name => \"unique_external_id\", :column_name => \"default\", :label => \"Unique External Id\", :label_in_portal => \"Unique External Id\", :deleted => 0, :field_type => ContactField::DEFAULT_FIELD_PROPS[:default_unique_external_id][:type], :position => account.contact_form.contact_fields.length, :required_for_agent => 0, :visible_in_portal => 0, :editable_in_portal => 0, :editable_in_signup => 0, :required_in_portal => 0, :created_at => Time.now.to_s(:db), :updated_at => Time.now.to_s(:db) }.values.map do\n \"'#{f}'\"\n end.join(\",\")})\\n        \")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "SAAS::AccountDataCleanup",
        "method": "handle_unique_contact_identifier_add_data"
      },
      "user_input": "ContactField::DEFAULT_FIELD_PROPS[:default_unique_external_id]",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "f063c60c56c9b98ba008b1dd232a4e0d5a58e51cd46ee4ba77c30f1c3184d11d",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/filters/custom_ticket_filter.rb",
      "line": 151,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "self.accessible.update_attributes(self.visibility)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Filters::CustomTicketFilter",
        "method": "save_accessible"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "f087961da904eff9b1f1d3e0441d0ca514bf65e2e58eecee844f588ca98c29fc",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/controllers/support/discussions/posts_controller.rb",
      "line": 53,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "SQSPost.new(params[:post].clone.delete_if do\n (k == \"attachments\")\n end)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Support::Discussions::PostsController",
        "method": "sqs_create"
      },
      "user_input": "params[:post].clone.delete_if",
      "confidence": "High",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "f093c49df309786ccfccc2c3836d86d90cfa2f1ab0448458b87aeb0518a32da6",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/reports/company_report.rb",
      "line": 35,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Account.current.tickets.visible.find(:all, :joins => \"INNER JOIN helpdesk_ticket_states on helpdesk_tickets.id = helpdesk_ticket_states.ticket_id and helpdesk_tickets.account_id = helpdesk_ticket_states.account_id\", :conditions => ([\"(`helpdesk_tickets.owner_id` = ?) AND (helpdesk_ticket_states.resolved_at > '#{start_date}' and helpdesk_ticket_states.resolved_at < '#{end_date}' )\", params[:customer_id]]))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::CompanyReport",
        "method": "count_of_resolved_tickets"
      },
      "user_input": "start_date",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "f2b243b09baa329df272ab773088c9f33993ac8c1a5e4d209be36da506ed53e5",
      "message": "Possible SQL injection",
      "file": "lib/sync/util.rb",
      "line": 33,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "ActiveRecord::Base.connection.execute(\"DELETE from #{table} where account_id = #{account_id}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Sync::Util",
        "method": "clear_staging_data"
      },
      "user_input": "table",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "f30a5ecd1bf6e186af90e33851a2205594371f28de4ca4528061b44252e30372",
      "message": "Possible SQL injection",
      "file": "lib/publisher.rb",
      "line": 5,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Account.current.send(options[:rel_table_args][:account_association]).where(\"#{options[:rel_table]}.id IN (?)\", options[:ids])",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Publisher",
        "method": "publish_to_central"
      },
      "user_input": "options[:rel_table]",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "f495b5359e1fe4e671964a602bdb6fa73b4cd0efe3471c690aeec4e5077f398a",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/archive_tickets/show/_custom_activity.html.erb",
      "line": 27,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.system_activity_timestamp\", :system_rule => link_to_system_rule((Unresolved Model).new.rule), :timestamp => format_activity_date((Unresolved Model).new.performed_time, true).to_i, :note_date => formated_date(format_activity_date((Unresolved Model).new.performed_time, true)))",
      "render_path": [
        {
          "type": "template",
          "name": "helpdesk/archive_tickets/activitiesv2",
          "line": 3,
          "file": "app/views/helpdesk/archive_tickets/activitiesv2.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/archive_tickets/show/_custom_activity"
      },
      "user_input": "(Unresolved Model).new.performed_time",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "f4dabcf0a6bafc9d53742f5f792b5656bfb2b68de11236e1c8287ed3adbb9c00",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "lib/remote_file.rb",
      "line": 45,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`file --mime -br #{self.path}`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "RemoteFile",
        "method": "content_type"
      },
      "user_input": "self.path",
      "confidence": "Medium",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "f5b27c9a428f0ff90161e7b754b38ee4961ad72cab84b41a86b7e09ecc662beb",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/account/subscription_methods.rb",
      "line": 35,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "DeletedCustomers.create(customer_details)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Account",
        "method": "create_deleted_customers_info"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "f892c446178a39979815bf64a1324b95e9f3aada52bb287eb935a6c5a6a56b31",
      "message": "Unescaped model attribute",
      "file": "app/views/helpdesk/tickets/show/_activity.html.erb",
      "line": 19,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "t(\"ticket.activity_timestamp\", :user_name => link_to_user((Unresolved Model).new[:user], :class => \"user_name\"), :timestamp => (Unresolved Model).new[:time].to_i, :note_date => formated_date((Unresolved Model).new[:time]))",
      "render_path": [
        {
          "type": "controller",
          "class": "Helpdesk::TicketsController",
          "method": "activities",
          "line": 1342,
          "file": "app/controllers/helpdesk/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "helpdesk/tickets/activities",
          "line": 3,
          "file": "app/views/helpdesk/tickets/activities.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "helpdesk/tickets/show/_activity"
      },
      "user_input": "(Unresolved Model).new[:time]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Cross Site Scripting",
      "warning_code": 2,
      "fingerprint": "fa48e200fe7e03c7663d4ab8290db772f8d1826fd0e9dc06e25022a84e1d1194",
      "message": "Unescaped parameter value",
      "file": "app/views/public/tickets/_archived_ticket.html.erb",
      "line": 26,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "current_account.schema_less_tickets.find_by_access_token(params[:id]).ticket.description_html",
      "render_path": [
        {
          "type": "controller",
          "class": "Public::TicketsController",
          "method": "show",
          "line": 11,
          "file": "app/controllers/public/tickets_controller.rb"
        },
        {
          "type": "template",
          "name": "public/tickets/show",
          "line": 2,
          "file": "app/views/public/tickets/show.html.erb"
        }
      ],
      "location": {
        "type": "template",
        "template": "public/tickets/_archived_ticket"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "faac769090b42361ef0cd0bd702af5fbbe270d9ebf852414b7a1621851897a5d",
      "message": "Model attribute used in file name",
      "file": "lib/helpdesk/export_data_worker.rb",
      "line": 25,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "File.open(File.join(\"#{Rails.root}/tmp/\", \"#{Account.find_by_full_domain(params[:domain]).id}.zip\"), \"r\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::ExportDataWorker",
        "method": "perform"
      },
      "user_input": "Account.find_by_full_domain(params[:domain])",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 17,
      "fingerprint": "fd818797297d28a0940bb1649505b099697042fe05c959d95a931bc24eb630cc",
      "check_name": "MassAssignment",
      "message": "Unprotected mass assignment",
      "file": "app/models/helpdesk/ticket/s3.rb",
      "line": 9,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "Helpdesk::TicketBody.new(Helpdesk::S3::Ticket::Body.get_from_s3(self.account_id, self.id))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Helpdesk::Ticket",
        "method": "read_from_s3"
      },
      "user_input": null,
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "fe55d0f271f314178fe373cce2f453baa791cb43176718eb2eaee35ffdf4760c",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/search/filters/docs.rb",
      "line": 81,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "model_class.constantize.joins(([] or [:ticket_states])).where(:account_id => Account.current.id, :id => (JSON.parse(es_request(model_class, \"_search\", :_source => false, :sort => ({ options[:order_entity].to_sym => options[:order_sort].to_s }), :size => (options[:per_page].presence or 30).to_i, :from => ((options[:per_page].presence or 30).to_i * (options[:page].to_i - 1))))[\"hits\"][\"hits\"].collect do\n record[\"_id\"]\n end)).order((\"#{:BRAKEMAN_SAFE_LITERAL} #{options[:order_sort]}, helpdesk_tickets.created_at asc\" or \"#{options[:order_entity]} #{options[:order_sort]}\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Search::Filters::Docs",
        "method": "records"
      },
      "user_input": "options[:order_sort]",
      "confidence": "Weak",
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "fe71b06e7d06089c725c66bf6a4c6c8b119a98184078b06df68dd8bf96cc49b3",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/reports/helpdesk_report.rb",
      "line": 62,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Account.current.tickets.visible.find(:all, :joins => \"INNER JOIN helpdesk_ticket_states on helpdesk_tickets.id = helpdesk_ticket_states.ticket_id and helpdesk_tickets.account_id = helpdesk_ticket_states.account_id\", :conditions => (\" (helpdesk_ticket_states.resolved_at > '#{start_date}' and helpdesk_ticket_states.resolved_at < '#{end_date}')\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reports::HelpdeskReport",
        "method": "count_of_resolved_tickets"
      },
      "user_input": "start_date",
      "confidence": "Medium",
      "note": "The embed is within quoted text"
    }
  ],
  "updated": "2020-05-05 09:47:14 +0530",
  "brakeman_version": "3.7.2"
}
