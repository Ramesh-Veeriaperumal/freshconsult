<%
	var tableTrClass = function (i) {
		if (i % 2 == 0) { 
			return 'even'; 
		} else{ 
			return 'odd';
		}
	};
	
	var agentTdTmpl = function (data, i, j, agent_metrics) {
		var metric_data, td_class,tooltip_tmpl = "";
		var current_data = data[i][agent_metrics[j]];
		var enable_tooltip = false;
		
		if(consts.sla_metrics.indexOf(agent_metrics[j]) > -1 && !HelpdeskReports.locals.is_sla_management_enabled  ) {
			return "";
		}

		if (consts.percentage_metrics.indexOf(agent_metrics[j]) > -1) {
			metric_data = HelpdeskReports.CoreUtil.addsuffix(current_data);
			td_class = (typeof current_data !== 'number') ? 'disable' : ( HelpdeskReports.locals.enable_ticket_list ? '' : 'disable'  );
		} else if (consts.time_metrics.indexOf(agent_metrics[j]) > -1) { 
			metric_data = HelpdeskReports.CoreUtil.timeMetricConversion(current_data);
			td_class = 'disable'; //Always disabling
		} else { 
			metric_data = HelpdeskReports.CoreUtil.shortenLargeNumber(current_data, 1);
			td_class = (typeof current_data !== 'number') ? 'disable' : ( HelpdeskReports.locals.enable_ticket_list ? '' : 'disable'  );
			enable_tooltip = true;
		}

		if(data[i]['deleted']){
			td_class += " deleted ";
		}
		var tmpl =  "<td style='font-style:normal' data-agent-id=" + data[i]['agent_id'] + " class='" + td_class + "' data-metric-name=" + agent_metrics[j];
		tmpl += " data-order = '" + current_data + "'";
		tmpl += tooltip_tmpl;
		tmpl += ">" ;
		if(enable_tooltip && current_data > 9999){
			tmpl += '<span class="tooltip" data-placement="above" data-original-title="'+ current_data +'" twipsy-content-set="true">' + metric_data + '</span>';
		} else {
			tmpl += metric_data;
		}
		tmpl +="</td>";

		return tmpl;
	};

	var consts = jQuery.extend({}, HelpdeskReports.Constants.AgentSummary);
	var agent_metrics = consts.metrics;
%>

<%if (data && data.length>0) { %>
	<% for (var i = 0; i < data.length; i++) { %>
		<tr class="<%= tableTrClass(i) %>" >
			<%
				var td_name_class = "disable agent";
				var agent_name = "";
				if(data[i]['deleted']) {
					td_name_class += " deleted ";
					agent_name = '<span class="tooltip" data-placement="above" data-original-title="Deleted Agent" twipsy-content-set="true">' +  data[i]['agent_name'] +'</span>';
				} else{
					agent_name = data[i]['agent_name'];
				} 
			%>
			<td data-agent-id="<%= data[i]['agent_id'] %>" class = "<%= td_name_class %>" ><%= agent_name  %></td>
			<% for (var j = 0; j < agent_metrics.length; j++) { %>
				<% var summary_tmpl = agentTdTmpl(data, i, j, agent_metrics); %>
					<%= summary_tmpl%>
			<% } %> 
		</tr>
	<% } %>
<% } %>